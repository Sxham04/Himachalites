<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Himachalites</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style4.css">
    <link rel="icon" type="image/webp" href="img/Frame 9.webp">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&family=Shadows+Into+Light+Two&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollToPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/lenis@1.1.13/dist/lenis.min.js"></script>
    <style>
    /* Hide mobile and tablet SVGs by default */
    #mobile-line-svg, #tablet-line-svg {
        display: none;
    }

    #svg-tip-counter, 
    #Line, 
    #mobile-line-path, 
    #tablet-line-path {
        will-change: transform, stroke-dashoffset;
        transform: translateZ(0); /* Hardware Acceleration */
        -webkit-transform: translateZ(0);
    }

/* --- TABLET STYLES --- */
    @media (min-width: 601px) and (max-width: 1024px) {
        /* Hide desktop and mobile SVGs */
        .dashed-line-center, #mobile-line-svg {
            display: none;
        }

        /* SHOW the tablet SVG */
        #tablet-line-svg {
            display: block;
            width: 100%;
            height: 100%; /* Fills height set by JS */
            position: absolute;
            top: 0;
            left: 0;
        }

        #tablet-line-path {
            stroke-dasharray: 15 !important;
        }

        /* Generic container styles for tablet/mobile */
        .top-content-wrapper { position: relative !important; }
        .dashed-line {
            display: block !important;
            position: absolute !important;
            margin: 0 !important;
            width: 90% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            z-index: 1;
            pointer-events: none;
        }
        #svg-tip-counter { z-index: 2; pointer-events: all; }
    }

/* --- MOBILE STYLES --- */
    @media (max-width: 600px) {
        /* Hide desktop and tablet SVGs */
        .dashed-line-center, #tablet-line-svg {
            display: none;
        }

        /* Show the mobile SVG */
        #mobile-line-svg {
            display: block;
            width: 100%;
            height: 100%; /* Fills height set by JS */
            position: absolute;
            top: 0;
            left: 0;
        }

        /* Generic container styles for tablet/mobile */
        .top-content-wrapper { position: relative !important; }
        .dashed-line {
            display: block !important;
            position: absolute !important;
            margin: 0 !important;
            width: 90% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            z-index: 1;
            pointer-events: none;
        }
        #svg-tip-counter { z-index: 2; pointer-events: all; }
    }
    #scrollToBottomBtn.is-hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        transform: scale(0.5);
        transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
    }
    .altitude-unit {
        font-weight: 500;
        margin-left: 0.2em;
    }

    /* Optimized CSS for GPU-accelerated movement: */
    #svg-tip-counter {
        position: absolute;
        width: 120px;
        height: 120px;
        z-index: 10;
        opacity: 0;
        /* Initialize with translate3d for hardware acceleration */
        transform: translate3d(0, 0, 0) translate(-50%, -50%) rotate(0deg);
        /* Rely on transform for updates */
        transition: opacity 0.3s ease,
                    transform 0.1s linear;
        /* Set left/top once */
        top: 0;
        left: 0;
        will-change: transform, opacity; /* Inform the browser this will be animated */
    }

    @media (max-width: 500px){
        #svg-tip-counter {
            width: 80px;
            height:80px;
        }

        .counter-text {
            font-size: 10px !important;
        }
    }

    .counter-bg-image {
        width: 100%;
        height: 100%;
    }

    .counter-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, 50%) rotate(90deg);
        color: black;
        font-size: 14px;
        font-weight: 600;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        white-space: nowrap;
    }

/* Initial state for scroll-triggered animations: elements are invisible and blurred */
    .state-container .info-column > h2,
    .state-container .info-column > p,
    .state-container .info-column > .info-button {
        opacity: 0;
        filter: blur(10px);
        transition: opacity 0.6s ease-out, filter 0.6s ease-out;
    }

    /* Staggered animation effect via delays */
    .state-container .info-column > p {
        transition-delay: 0.1s;
    }
    .state-container .info-column > .info-button {
        transition-delay: 0.2s;
    }

    /* Final state: triggered by JS adding the 'is-visible' class */
    .state-container.is-visible .info-column > h2,
    .state-container.is-visible .info-column > p,
    .state-container.is-visible .info-column > .info-button {
        opacity: 1;
        filter: blur(0px);
    }
    </style>
</head>
<body>
<div id="splash-screen">
    <div class="splash-content">
        <img id="splash-image" src="img/splash.webp" alt="Splash Screen Image">
        <div class="loader"></div>
    </div>
</div>
    <div class="footer">
        <div class="footer-copyright">
            <p>Copyright &copy; 2025. Swaggytoon. All Rights Reserved.</p>
        </div>
        <div class="footer-main-content">
            <div class="footer-column">
                <h4>About US</h4>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#">Merch</a></li>
                    <li><a href="about.html">About</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Contact Info</h4>
                <ul>
                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Social Connect</h4>
                    <ul>
                        <li><a href="http://instagram.com/himachalites/" target="_blank" rel="noopener noreferrer">Instagram <i class="fa-brands fa-instagram"></i></a></li>
                        <li><a href="https://www.youtube.com/@himachalites" target="_blank" rel="noopener noreferrer">Youtube <i class="fa-brands fa-youtube"></i></a></li>
                        <li><a href="https://www.facebook.com/himachalities" target="_blank" rel="noopener noreferrer">Facebook <i class="fa-brands fa-facebook"></i></a></li>
                    </ul>
            </div>
        </div>
        <div class="parallax-backgrounds">
            <div class="parallax-layer layer-1">
                <img srcset="f/720px/Back Mountains.webp 720w,
                      f/1080px/Back Mountains.webp 1900w,
                      f/1440px/Back Mountains.webp 2000w,
                      f/2160px/Back Mountains.webp 3000w"
                      sizes="100vw"
                      src="f/1080px/Back Mountains.webp"
                      alt="Distant back mountains">
            </div>

            <div class="parallax-layer layer-2">
                <img srcset="f/720px/Front Mountains.webp 720w,
                      f/1080px/Front Mountains.webp 1900w,
                      f/1440px/Front Mountains.webp 2000w,
                      f/2160px/Front Mountains.webp 3000w"
                      sizes="100vw"
                      src="f/1080px/Front Mountains.webp"
                      alt="Closer front mountains">
            </div>

            <div class="parallax-layer layer-3">
                <img srcset="f/720px/Footer forest.webp 720w,
                      f/1080px/Footer forest.webp 1900w,
                      f/1440px/Footer forest.webp 2000w,
                      f/2160px/Footer forest.webp 3000w"
                      sizes="100vw"
                      src="f/1080px/Footer forest.webp"
                      alt="A dense forest line">
            </div>

            <div class="parallax-layer layer-4">
                <img class="figure-left"
                      srcset="f/1440px/Women.webp 720w,
                      f/1440px/Women.webp 1920w,
                      f/1440px/Women.webp 2000w,
                      f/2160px/Women.webp 3000w"
                      src="f/1080px/Women.webp"
                      sizes="35vw"
                      alt="Illustration of a woman">
                <img class="figure-right"
                      srcset="f/1440px/Men.webp 720w,
                      f/1440px/Men.webp 1920w,
                      f/1440px/Men.webp 2000w,
                      f/2160px/Men.webp 3000w"
                      src="f/1080px/Men.webp"
                      sizes="35vw"
                      alt="Illustration of a man">
            </div>

            <div class="parallax-layer layer-5">
                <img srcset="f/720px/Bottom Clouds.webp 720w,
                      f/1080px/Bottom Clouds.webp 19200w,
                      f/1440px/Bottom Clouds.webp 2000w,
                      f/2160px/Bottom Clouds.webp 3000w"
                      src="f/1080px/Bottom Clouds.webp"
                      sizes="100vw"
                      alt="Layer of fog or clouds">
            </div>
        </div>
    </div>
    <div id="scroll-container">
    <div class="top-content-wrapper">
        <div class="dashed-line">
            <div id="svg-tip-counter">
                <img class="counter-bg-image" src="img/Bus.webp" alt="Path indicator arrow">
                <div class="counter-text">0 ft</div>
            </div>
            <svg
                class="dashed-line-center"
                viewBox="0 0 1693 9131"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                role="img"
                aria-labelledby="line-title"
                preserveAspectRatio="none">
                <title id="line-title">Decorative dashed line</title>

                <defs>
                    <mask id="line-drawing-mask">
                        <path
                            id="mask-path"
                            d="M911 9133C911 9083.5 937.499 8875.8 872 8851C806.501 8826.2 808.924 8794.33 839 8724.5C847.076 8698.33 840.063 8620.8 749.5 8600C658.937 8579.2 587.063 8575.5 562 8563C509.367 8539.67 448.375 8528 601.095 8520C753.815 8512 785.474 8542.67 806.5 8540C821.104 8544.16 907.587 8566.39 997 8475C1059.47 8424.76 1154.32 8367.5 1356.5 8407C1405.79 8415.5 1417.13 8395.5 1466 8343C1486.72 8329.8 1568.5 8345 1613 8299.5C1643.5 8268.31 1585.6 8251.3 1613 8218.5C1647.25 8177.5 1720.95 8071 1679 7935C1655.61 7894 1643.12 7849.5 1595.5 7856C1552.73 7845.6 1556.72 7764 1535 7733.5C1522.33 7712.5 1402.59 7654.3 1303 7679.5C1178.52 7711 1073.62 7727.5 926.163 7632.5C803.353 7544 738.16 7598.5 477.5 7632.5C377.664 7640.5 56.3293 7698.5 25 7536.5C-0.0634441 7406.9 10.7721 7056 13 7001.5C27.4811 6936.67 123.632 6930.5 235.248 6934.5C335.084 6938 438.262 6913.5 505.516 6877.5C572.769 6841.5 613.706 6837 782.884 6877.5C952.063 6918 1077.38 6946 1436.62 6867.5C1465.03 6857.1 1504.99 6830.5 1521.42 6818.5C1527.41 6809.17 1548.91 6785.3 1587 6764.5C1634.62 6738.5 1682.24 6450.5 1664.7 6346C1647.16 6241.5 1635.04 6073 1469.62 6119C1349.32 6161.5 1277.89 6181.5 1085.73 6135.5C1026.92 6122.3 964.873 6108 941.202 6102.5C910.708 6079.83 836.353 6035.1 782.884 6037.5C716.048 6040.5 675.529 5978.5 735.264 5934.5C794.998 5890.5 874.784 5832 822.568 5763C770.353 5694 767.429 5661 805.859 5591C844.29 5521 822.986 5462 720.226 5493C619.137 5501.5 638.352 5452 710.618 5388.5C782.884 5334.5 920.315 5250 1298.77 5297.5C1358.93 5302.5 1681.6 5314.5 1663.5 5046C1648.51 4823.63 1654.39 4792.5 1631 4750C1607.61 4707.5 1537.5 4708.5 1401 4685.5C1315.98 4663.5 1332.89 4620.83 1298.77 4586.5C1273.15 4559.83 1168.1 4505 1063.5 4569C961.158 4606.5 903.189 4640.5 640.44 4613.5C522.141 4591.9 391 4546 303 4560C215 4574 106.671 4607.5 57.5 4538.5C8.3286 4469.5 63.5 4443.5 57.5 4406.5C51.6205 4370.24 3.99997 4386.5 3.99997 4317.5C3.99997 4257.5 63.728 4248.5 25 4198C4.09119 4170.74 -4 4040 82.1952 3985C114.778 3956 136.499 3926.5 137.752 3900.5C139.006 3874.5 168.246 3866 202.5 3861.5C229.902 3857.9 396.907 3896.67 490.478 3861.5C509.832 3856.17 544.42 3823.2 642 3836C737.575 3825.6 793.884 3789.83 819.644 3767C825.91 3756.33 916.723 3757.7 1039.37 3796.5C1200.61 3814.5 1584.23 3749 1659 3624C1699.45 3556.38 1638.32 3511.81 1634 3418.5C1630.33 3339.33 1677.39 3251.83 1659 3213C1618.03 3126.5 1504 3122.5 1405.5 3122.5C1258.13 3122.5 1272 3053.5 1111 3110C1075.91 3115 1022.86 3160.5 971.48 3042C930.376 2947.2 866 3024.5 792.492 2969C754 2908 741.446 2897.7 819.644 2814.5C917.391 2710.5 909.455 2670.5 844.29 2568C779.125 2465.5 493.884 2203.5 803 2148.5C981.117 2120.1 1163.5 2265.68 1464 2199C1563.14 2177 1754.26 2035.1 1651 1841.5C1616.25 1776.3 1590 1781 1541 1735.5C1501 1688 1569.58 1665.15 1584 1624.5C1600.5 1578 1548.5 1529.5 1452 1555C1384.5 1572.84 1341.56 1593.6 1316.5 1578C1291.44 1562.4 1243.5 1520 1175 1530.5C1065.5 1547.28 1055 1613.45 965.5 1518.5C891.98 1440.5 864.747 1450.5 767 1449C669.252 1447.5 715.107 1374.5 527.966 1373C340.826 1371.5 220.886 1430.5 167 1427C113.113 1423.5 -3.51266 1370 23.6394 1269.5C50.7915 1169 61.2346 1110.5 15.2849 1070C-21.4748 1037.6 22.5255 981.833 49.1206 958C66.8042 931 88.0525 879.9 31.5762 891.5C-17.214 883.5 11.2469 849.167 31.5762 833C60.1206 814.667 173.261 773 267.5 795C328.488 800 380.616 819 414.452 757C448.287 695 499.455 574.017 644.72 619.008C712.707 651.5 780.378 697 906.531 533C926.999 489 945.8 467.895 906.531 322C874.5 203 843 71.5 1139 1.5"
                            stroke="white"
                            stroke-width="5" />
                    </mask>
                </defs>

                <path
                    id="Line"
                    mask="url(#line-drawing-mask)"
                    d="M911 9133C911 9083.5 937.499 8875.8 872 8851C806.501 8826.2 808.924 8794.33 839 8724.5C847.076 8698.33 840.063 8620.8 749.5 8600C658.937 8579.2 587.063 8575.5 562 8563C509.367 8539.67 448.375 8528 601.095 8520C753.815 8512 785.474 8542.67 806.5 8540C821.104 8544.16 907.587 8566.39 997 8475C1059.47 8424.76 1154.32 8367.5 1356.5 8407C1405.79 8415.5 1417.13 8395.5 1466 8343C1486.72 8329.8 1568.5 8345 1613 8299.5C1643.5 8268.31 1585.6 8251.3 1613 8218.5C1647.25 8177.5 1720.95 8071 1679 7935C1655.61 7894 1643.12 7849.5 1595.5 7856C1552.73 7845.6 1556.72 7764 1535 7733.5C1522.33 7712.5 1402.59 7654.3 1303 7679.5C1178.52 7711 1073.62 7727.5 926.163 7632.5C803.353 7544 738.16 7598.5 477.5 7632.5C377.664 7640.5 56.3293 7698.5 25 7536.5C-0.0634441 7406.9 10.7721 7056 13 7001.5C27.4811 6936.67 123.632 6930.5 235.248 6934.5C335.084 6938 438.262 6913.5 505.516 6877.5C572.769 6841.5 613.706 6837 782.884 6877.5C952.063 6918 1077.38 6946 1436.62 6867.5C1465.03 6857.1 1504.99 6830.5 1521.42 6818.5C1527.41 6809.17 1548.91 6785.3 1587 6764.5C1634.62 6738.5 1682.24 6450.5 1664.7 6346C1647.16 6241.5 1635.04 6073 1469.62 6119C1349.32 6161.5 1277.89 6181.5 1085.73 6135.5C1026.92 6122.3 964.873 6108 941.202 6102.5C910.708 6079.83 836.353 6035.1 782.884 6037.5C716.048 6040.5 675.529 5978.5 735.264 5934.5C794.998 5890.5 874.784 5832 822.568 5763C770.353 5694 767.429 5661 805.859 5591C844.29 5521 822.986 5462 720.226 5493C619.137 5501.5 638.352 5452 710.618 5388.5C782.884 5334.5 920.315 5250 1298.77 5297.5C1358.93 5302.5 1681.6 5314.5 1663.5 5046C1648.51 4823.63 1654.39 4792.5 1631 4750C1607.61 4707.5 1537.5 4708.5 1401 4685.5C1315.98 4663.5 1332.89 4620.83 1298.77 4586.5C1273.15 4559.83 1168.1 4505 1063.5 4569C961.158 4606.5 903.189 4640.5 640.44 4613.5C522.141 4591.9 391 4546 303 4560C215 4574 106.671 4607.5 57.5 4538.5C8.3286 4469.5 63.5 4443.5 57.5 4406.5C51.6205 4370.24 3.99997 4386.5 3.99997 4317.5C3.99997 4257.5 63.728 4248.5 25 4198C4.09119 4170.74 -4 4040 82.1952 3985C114.778 3956 136.499 3926.5 137.752 3900.5C139.006 3874.5 168.246 3866 202.5 3861.5C229.902 3857.9 396.907 3896.67 490.478 3861.5C509.832 3856.17 544.42 3823.2 642 3836C737.575 3825.6 793.884 3789.83 819.644 3767C825.91 3756.33 916.723 3757.7 1039.37 3796.5C1200.61 3814.5 1584.23 3749 1659 3624C1699.45 3556.38 1638.32 3511.81 1634 3418.5C1630.33 3339.33 1677.39 3251.83 1659 3213C1618.03 3126.5 1504 3122.5 1405.5 3122.5C1258.13 3122.5 1272 3053.5 1111 3110C1075.91 3115 1022.86 3160.5 971.48 3042C930.376 2947.2 866 3024.5 792.492 2969C754 2908 741.446 2897.7 819.644 2814.5C917.391 2710.5 909.455 2670.5 844.29 2568C779.125 2465.5 493.884 2203.5 803 2148.5C981.117 2120.1 1163.5 2265.68 1464 2199C1563.14 2177 1754.26 2035.1 1651 1841.5C1616.25 1776.3 1590 1781 1541 1735.5C1501 1688 1569.58 1665.15 1584 1624.5C1600.5 1578 1548.5 1529.5 1452 1555C1384.5 1572.84 1341.56 1593.6 1316.5 1578C1291.44 1562.4 1243.5 1520 1175 1530.5C1065.5 1547.28 1055 1613.45 965.5 1518.5C891.98 1440.5 864.747 1450.5 767 1449C669.252 1447.5 715.107 1374.5 527.966 1373C340.826 1371.5 220.886 1430.5 167 1427C113.113 1423.5 -3.51266 1370 23.6394 1269.5C50.7915 1169 61.2346 1110.5 15.2849 1070C-21.4748 1037.6 22.5255 981.833 49.1206 958C66.8042 931 88.0525 879.9 31.5762 891.5C-17.214 883.5 11.2469 849.167 31.5762 833C60.1206 814.667 173.261 773 267.5 795C328.488 800 380.616 819 414.452 757C448.287 695 499.455 574.017 644.72 619.008C712.707 651.5 780.378 697 906.531 533C926.999 489 945.8 467.895 906.531 322C874.5 203 843 71.5 1139 1.5"
                    stroke="black"
                    stroke-width="2"
                    stroke-dasharray="7 7" />
            </svg>
            <svg id="mobile-line-svg" viewBox="0 0 398 11700" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">

                <defs>
                    <mask id="mobile-drawing-mask">
                        <path id="mobile-mask-path"
d="M242 11736c43-16 103-45 119-87 15-42 36-127 21-207-14-69-27-190-199-203-134-11-213-155-166-244 44-65-32-218 126-225 166-7 267-191 241-315-34-162-141-240-203-244-46-5-160-34-141-121 21-64-26-43-36-169-9-50 42-165 130-163 77-5 242-18 255-206 3-102-1-368-93-393-182-50-292-54-282-224 9-49 61-149 168-152 134-3 161-61 168-124s39-91 39-196c0-88-26-176-32-214-7-38-32-16-195-5-111 0-155-43-141-189 17-99-20-210 30-238 38-22 165-22 238-68 27-18 77-38 82-191 5-141-7-114 13-188 5-19-17-71-120-91-138-27-245-29-231-100s-52-248 12-315c64-68 290-22 316-146s51-349-31-421c-45-39-230 12-300-90-51-88-26-310 18-355 44-46 112 30 220-9 132-49 131-280 106-386-7-62-151-97-257-123-134-34-136-384-46-432 61-20 132 28 257 0 65-20 15-48 49-330 8-66 22-96-17-146-18-24-68-60-129-69-88-14-133 26-209-96-53-87 19-306 74-346 120-104 260 51 275-85 7-106 31-326-19-397-63-89-192-31-266-59s-59-54-71-120c-16-83-18-259 44-297 49-30 257 103 303-32 28-192 46-303 0-448-34-105-160-59-236-71-97-16-124-123-118-163 18-120-6-263 79-297 77-31 299-44 299-288s-242-195-341-236c-91-39-22-346 56-428 77-83 238 67 265-25 26-92 42-505-60-559-62-34-130-37-193-40-71-4-118-35-93-152C65 9 123 139 215 1"
                        stroke="white"
                        stroke-width="5"/>
                    </mask>
                </defs>
                <path id="mobile-line-path"
                    mask="url(#mobile-drawing-mask)"
d="M242 11736c43-16 103-45 119-87 15-42 36-127 21-207-14-69-27-190-199-203-134-11-213-155-166-244 44-65-32-218 126-225 166-7 267-191 241-315-34-162-141-240-203-244-46-5-160-34-141-121 21-64-26-43-36-169-9-50 42-165 130-163 77-5 242-18 255-206 3-102-1-368-93-393-182-50-292-54-282-224 9-49 61-149 168-152 134-3 161-61 168-124s39-91 39-196c0-88-26-176-32-214-7-38-32-16-195-5-111 0-155-43-141-189 17-99-20-210 30-238 38-22 165-22 238-68 27-18 77-38 82-191 5-141-7-114 13-188 5-19-17-71-120-91-138-27-245-29-231-100s-52-248 12-315c64-68 290-22 316-146s51-349-31-421c-45-39-230 12-300-90-51-88-26-310 18-355 44-46 112 30 220-9 132-49 131-280 106-386-7-62-151-97-257-123-134-34-136-384-46-432 61-20 132 28 257 0 65-20 15-48 49-330 8-66 22-96-17-146-18-24-68-60-129-69-88-14-133 26-209-96-53-87 19-306 74-346 120-104 260 51 275-85 7-106 31-326-19-397-63-89-192-31-266-59s-59-54-71-120c-16-83-18-259 44-297 49-30 257 103 303-32 28-192 46-303 0-448-34-105-160-59-236-71-97-16-124-123-118-163 18-120-6-263 79-297 77-31 299-44 299-288s-242-195-341-236c-91-39-22-346 56-428 77-83 238 67 265-25 26-92 42-505-60-559-62-34-130-37-193-40-71-4-118-35-93-152C65 9 123 139 215 1"
                    stroke="black"
                    stroke-width="2"
                    stroke-dasharray="7 7"/>
            </svg>

            <svg id="tablet-line-svg" viewBox="0 0 978 6090" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
                <defs>
                    <mask id="tablet-drawing-mask">
                        <path
                            id="tablet-mask-path"
                            d="M548 6097.5C558 6073.59 520.767 5989.11 534 5945C546 5905 567.458 5813.36 548 5775C530.5 5740.5 415 5657 500 5622.5C585 5588 399.5 5561 383.5 5533.5C367.5 5506 383.499 5497.5 433.999 5417C484.499 5336.5 484.957 5200.71 304 5157.5C126.001 5115 324 5077 416 5040C508 5003 777.273 4623.25 424.5 4600C29.9998 4574 -0.999695 4454 1.50031 4341C3.50031 4250.6 35.8689 4151.75 95.5 4112C196 4045 219.58 4055.38 356 4034.5C509.5 4011 554 4002.5 588 3953.5C605.694 3928 623.969 3863.24 562.5 3819.5C510.5 3782.5 549.434 3715.09 554 3656C562.5 3546 494.736 3630.09 407 3604.5C371 3594 360.5 3549.5 360.5 3526.5C369.5 3484.7 277.466 3489.55 157.703 3484.2C37.9405 3478.84 7.9998 3317.83 7.9998 3238C6.49998 3173 41.7003 3041.1 194.5 3033.5C347.3 3025.9 443.998 3030.5 472.499 2984.5C501 2938.5 558 2901.3 700 3000.5C856.8 3081.3 895.5 2978 921.5 2920.5C958.313 2816.19 951.395 2603.93 629.22 2589.29C307.044 2574.66 253 2520.67 293 2504.5C356.5 2478.83 436.5 2486 412.5 2346C382.5 2171 373.5 2106 284 2094.5C194.5 2083 318.425 1950.64 485.511 1964.1C619.179 1974.88 604.263 1892.24 580.097 1849.57C560.097 1821.57 524.296 1756.27 541.096 1719.07C562.096 1672.57 642.903 1568.43 572.5 1553.5C502.097 1538.57 433 1485 433 1450.5C433 1416 493.438 1172.95 398.469 1125.98C303.5 1079 169.938 1087.99 226.969 1031C272.594 985.399 333 953 357.5 942.5C390.5 933.5 503.481 874.946 573.481 896.546C660.981 923.546 667.019 965.454 713.5 931C759.981 896.546 760.481 865.046 841.481 872.546C922.481 880.046 1079.02 598.923 859.512 564.461C731.902 539.292 631.667 545 597.5 551C514.833 565 262.5 506.5 83.5 345C-68.5 218.5 20.5 -39 482 6"
                            stroke="white"
                            stroke-width="5"/>
                    </mask>
                </defs>
                <path
                    id="tablet-line-path"
                    mask="url(#tablet-drawing-mask)"
                    d="M548 6097.5C558 6073.59 520.767 5989.11 534 5945C546 5905 567.458 5813.36 548 5775C530.5 5740.5 415 5657 500 5622.5C585 5588 399.5 5561 383.5 5533.5C367.5 5506 383.499 5497.5 433.999 5417C484.499 5336.5 484.957 5200.71 304 5157.5C126.001 5115 324 5077 416 5040C508 5003 777.273 4623.25 424.5 4600C29.9998 4574 -0.999695 4454 1.50031 4341C3.50031 4250.6 35.8689 4151.75 95.5 4112C196 4045 219.58 4055.38 356 4034.5C509.5 4011 554 4002.5 588 3953.5C605.694 3928 623.969 3863.24 562.5 3819.5C510.5 3782.5 549.434 3715.09 554 3656C562.5 3546 494.736 3630.09 407 3604.5C371 3594 360.5 3549.5 360.5 3526.5C369.5 3484.7 277.466 3489.55 157.703 3484.2C37.9405 3478.84 7.9998 3317.83 7.9998 3238C6.49998 3173 41.7003 3041.1 194.5 3033.5C347.3 3025.9 443.998 3030.5 472.499 2984.5C501 2938.5 558 2901.3 700 3000.5C856.8 3081.3 895.5 2978 921.5 2920.5C958.313 2816.19 951.395 2603.93 629.22 2589.29C307.044 2574.66 253 2520.67 293 2504.5C356.5 2478.83 436.5 2486 412.5 2346C382.5 2171 373.5 2106 284 2094.5C194.5 2083 318.425 1950.64 485.511 1964.1C619.179 1974.88 604.263 1892.24 580.097 1849.57C560.097 1821.57 524.296 1756.27 541.096 1719.07C562.096 1672.57 642.903 1568.43 572.5 1553.5C502.097 1538.57 433 1485 433 1450.5C433 1416 493.438 1172.95 398.469 1125.98C303.5 1079 169.938 1087.99 226.969 1031C272.594 985.399 333 953 357.5 942.5C390.5 933.5 503.481 874.946 573.481 896.546C660.981 923.546 667.019 965.454 713.5 931C759.981 896.546 760.481 865.046 841.481 872.546C922.481 880.046 1079.02 598.923 859.512 564.461C731.902 539.292 631.667 545 597.5 551C514.833 565 262.5 506.5 83.5 345C-68.5 218.5 20.5 -39 482 6"
                    stroke="black"
                    stroke-width="2"
                    stroke-dasharray="7 7"/>
            </svg>

        </div>

<div class="state-content-sections">
            <section class="state-container state-container--split reverse state-container-1">
                <div class="cloud-layer">
                    <img src="img/cloud1.png" class="cloud-item cloud-1" alt="floating cloud">
                    <img src="img/cloud2.png" class="cloud-item cloud-2" alt="floating cloud">
                </div>
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/ls-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="25069">24,569</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-1">Lahaul & Spiti</h2>
                        <img src="img/weather/lns.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>High up in the cold desert, Lahaul and Spiti feel like another world. The valleys are wide, silent, and marked by white stupas and stone houses. People here live by the seasons, farming barley, drinking butter tea, and surviving long winters with quiet strength. Monasteries like Key and Tabo hold stories a thousand years old. 
                        <br>When the roads finally open after months of snow, it feels less like travel and more like discovery.</p>
                    <a href="dist/d1.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/lh.webp" alt="Scenic view of Lahaul & Spiti">
                </div>
            </section>

            <section class="state-container state-container--split state-container-2">
                <div class="cloud-layer">
                    <img src="img/cloud1.png" class="cloud-item cloud-3" alt="floating cloud">
                    <img src="img/cloud2.png" class="cloud-item cloud-4" alt="floating cloud">
                </div>
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/kinaur-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="22362">21,862</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-2">Kinnaur</h2>
                        <img src="img/weather/kinnaur.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Kinnaur sits where India touches Tibet, a land of deep valleys and calm faith. Buddhist prayer flags and Hindu temples stand side by side, showing how belief blends here instead of dividing. People wear the green Kinnauri cap with pride and press oil from apricot kernels. 
                        <br>In autumn, the hills turn festive for Phulaich, when flowers are offered to gods and friends alike. Kinnaur feels both distant and beautifully familiar.</p>
                    <a href="dist/d2.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Kin.webp" alt="Scenic view of Kinnaur">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-3">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/chamba-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="21759">21,259</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-3">Chamba</h2>
                        <img src="img/weather/chamba.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Chamba rests by the Ravi River, full of temples, embroidery, and songs that never left the mountains. Women still stitch the famous Chamba Rumal, and kitchens keep a jar of Chukh that adds more taste to any meal. During Minjar Mela, the town turns gold with silk threads and prayers for a good harvest. 
                        <br>If you travel towards Bharmour or Pangi, you’ll find a wilder Himachal: full of forests, faith, and old stories.</p>
                    <a href="dist/d3.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/cha.webp" alt="Scenic view of Chamba">
                </div>
            </section>

            <section class="state-container state-container--split state-container-4">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/kullu-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="21138">20,638</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-4">Kullu</h2>
                        <img src="img/weather/kullu.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Kullu is called the Valley of Gods, and every village proves it true. Deities travel in palanquins during Dussehra, when hundreds of gods gather to bless the valley. People here weave shawls, grow apples, and have meetha baath, chana dal, khatta and more during fairs or festivals. 
                        <br>From the busy town to the peaceful Tirthan and Banjar valleys, Kullu holds a beauty that feels both sacred and familiar, like home in the mountains.</p>
                    <a href="dist/d4.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Kul.webp" alt="Scenic view of Kullu">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-5">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/shimla-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="18069">17,569</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-5">Shimla</h2>
                        <img src="img/weather/shimla.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Shimla may be the capital, but its real beauty lies not only in its old colonial charm but also in the beautiful mountain life of Upper Shimla area. In Upper Shimla, mornings begin with temple bells and apple orchards shining under the mist. 
                        <br>Families cook siddu, bhadu dal and rajma on wood stoves while the city below runs the state. It’s where colonial rooftops blend with village homes, and every foggy evening feels like a page from an old story.</p>
                    <a href="dist/d5.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Shm.webp" alt="Scenic view of Shimla">
                </div>
            </section>

            <section class="state-container state-container--split state-container-6">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/kangra-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="16341">15,841</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-6">Kangra</h2>
                        <img src="img/weather/kangra.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Kangra stretches from the tea gardens of Palampur to the monasteries of McLeodganj and the temples of Jwalamukhi. It’s a district of many voices: the rhythm of Kangri songs, the taste of madra and khatta, the calm of McLeodganj’s streets. 
                        <br>Artists still paint in the old miniature style, and farmers pick tea leaves under soft morning light. Kangra doesn’t rush it unfolds quietly, one valley at a time.</p>
                    <a href="dist/d6.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Kang.webp" alt="Scenic view of Kangra">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-7">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/sirmaur-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="11965">11,465</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-7">Sirmaur</h2>
                        <img src="img/weather/sirmaur.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Sirmaur greets you with peach blossoms and kind faces. Known as the Peach Bowl of India, it’s a softer Himachal warmer, slower, and intensely local. At Renuka Ji Lake, the reflection of the goddess shimmers in the water, and fairs fill the air with music and prayer. 
                        <br>People cook ainkulu, patande, maah dal, pude, and speak Sirmauri with an easy smile. Faith and farming keep the rhythm steady here.</p>
                    <a href="dist/d7.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/SIr.webp" alt="Scenic view of Sirmaur">
                </div>
            </section>

            <section class="state-container state-container--split state-container-8">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/mandi-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="11123">10,623</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-8">Mandi</h2>
                        <img src="img/weather/mandi.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Mandi is where the hills sound like temple bells. Called Chhoti Kashi, it has more old shrines than streets, and during Shivratri, gods from hundreds of villages arrive together to celebrate. 
                        <br>People here still cook dham in brass pots: sepu badi, maah dal, and boondi ka meetha, served on leaf plates. For the snowcapped mountains, visit its serene villages like Barot and Janjehli. </p>
                    <a href="dist/d8.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Man.webp" alt="Scenic view of Mandi">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-9">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/solan-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="8018">7,518</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-9">Solan</h2>
                        <img src="img/weather/solan.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Solan is Himachal’s easy middle, never too hot, never too cold. It brews beer, grows mushrooms, and still finds time for a fair every summer. The Shoolini Festival fills the streets with laughter and drums, while nearby Kasauli stays calm under pine trees. 
                        <br>Solan feels less like a tourist stop and more like a place you could quietly belong.</p>
                    <a href="dist/d9.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Sol.webp" alt="Scenic view of Solan">
                </div>
            </section>

            <section class="state-container state-container--split state-container-10">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/bilaspur-icon(1).png" alt="District Icon">
                        <span class="altitude-value" data-final-value="6496">5,996</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-10">Bilaspur</h2>
                        <img src="img/weather/bilaspur.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Bilaspur was once a town on land; now half of it lies underwater. The old city was submerged to create Gobind Sagar Lake, and life moved uphill with it. People here fish, trade, and gather for the Nalwari Fair, where cattle, wrestling, and songs share the same field. 
                        <br>Bilaspuri dham is very famous and includes rajma madra, khatta, sepu badi, and sweet mitha, all cooked slowly in brass pots.</p>
                    <a href="dist/d10.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Bil.webp" alt="Scenic view of Bilaspur">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-11">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/hamirpur-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="4101">3,601</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-11">Hamirpur</h2>
                        <img src="img/weather/hamirpur.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Hamirpur doesn’t try to impress you; it wins you over slowly. It’s a land of soldiers, teachers, and storytellers, where evenings are filled with old jheras songs of heroes and home. 
                        <br>The hills are low, the people grounded, and the local dham is rich and earthy, cooked in mustard oil. Hamirpur stands for honesty, discipline, and quiet strength.</p>
                    <a href="dist/d11.html" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Hamir.webp" alt="Scenic view of Hamirpur">
                </div>
            </section>

            <section class="state-container state-container--split state-container-12">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/una-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="3937">3,437</span><span class="altitude-unit"> ft</span>
                    </div>
                    <div class="header-wrapper">
                        <h2 class="header-12">Una</h2>
                        <img src="img/weather/una.png" class="thin-content-image" alt="decoration">
                    </div>
                    <p>Una is the gateway to Himachal, warmer, flatter, and welcoming. Wheat grows where apples don’t, and the dialect carries the rhythm of both Himachal and Punjab. People greet you with “Sat Sri Akal” as easily as “Namaste.” 
                        <br>Chintpurni Temple, one of the famous Shakti Peeths, draws pilgrims all year round. Una connects two worlds, the plains and the hills,  and carries the heart of both.</p>
                    <a href="dist/d12.html" class="info-button">Explore</a>
                </div>
                <div class="image-column image-12">
                    <img src="img/Una.webp" alt="Scenic view of Una">
                </div>
            </section>
        </div>
    </div>
    </div>
    <div class="top-scroll-spacer"></div>
<div id="landing-page-container">
        <header>
            <div class="top-bar">
                <p>Keep Himalayas Clean & Plastic Free</p>
                <div class="social-links">
                    <a href="https://www.youtube.com/@himachalites" aria-label="YouTube" target="_blank" rel="noopener noreferrer"><i class="fa-brands fa-youtube"></i></a>
                    <a href="https://www.instagram.com/himachalites/" aria-label="Instagram" target="_blank" rel="noopener noreferrer"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.facebook.com/himachalities" aria-label="Facebook" target="_blank" rel="noopener noreferrer"><i class="fa-brands fa-facebook"></i></a>
                </div>
            </div>
            <nav class="navbar">
                <ul class="main-nav nav-left">
                    <li><a class="active">Home</a></li>
                    <li><a href="#">Merch</a></li>

                </ul>
                <div class="logo">
                    <img src="img/Frame 9.webp" alt="Himachalites Logo">
                </div>
                <ul class="main-nav nav-right">
                    <li><a href="about.html">About</a></li>

                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
                <button class="mobile-menu-button" id="mobile-menu-toggle" aria-label="Toggle Menu" aria-expanded="false">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </header>

        <main class="content-area">
            <div class="overlay-content">
                <img src="img/Header_Text.png" class="overlay-image" alt="Descriptive text">
            </div>
        </main>
        <div class="button-wrapper">
        <button class="overlay-button">
            <span class="button-arrows">
                <svg class="button-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <g fill="none">
                        <path d="M0 0h24v24H0z"/>
                        <path fill="currentColor" d="m11.226 8.358l-4.01 4.01a.75.75 0 1 1-1.06-1.06l4.54-4.54a.75.75 0 0 1 1.06 0l4.54 4.54a.75.75 0 0 1-1.06 1.06l-4.01-4.01Zm0 5.656l-4.01 4.01a.75.75 0 1 1-1.06-1.06l4.54-4.54a.75.75 0 0 1 1.06 0l4.54 4.54a.75.75 0 0 1-1.06 1.06l-4.01-4.01Z"/>
                    </g>
                </svg>
            </span>
            <span class="button-text">Take the Road Home.</span>
        </button>
        </div>
    </div>

    <a href="#landing-page-container" id="scrollToBottomBtn" title="Go to Landing Page">
        <i class="fas fa-arrow-down"></i>
    </a>
<div id="scroll-tutorial" class="tutorial-overlay">
    <div class="tutorial-content">
        <div class="mouse-icon">
            <div class="wheel"></div>
            <div class="arrow-up"></div>
        </div>
        <p class="tutorial-text">Scroll Up to Start Your Journey</p>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const footerColumns = document.querySelectorAll('.footer-column');

    footerColumns.forEach(column => {
        const heading = column.querySelector('h4');
        const list = column.querySelector('ul');

        if (heading && list) {
            list.addEventListener('mouseenter', () => {
                heading.classList.add('is-active');
            });

            list.addEventListener('mouseleave', () => {
                heading.classList.remove('is-active');
            });
        }
    });
});
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    // Ensure GSAP and ScrollTrigger are loaded
    if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {
        console.error("GSAP or ScrollTrigger not loaded!");
        return;
    }
    gsap.registerPlugin(ScrollTrigger);

    // Use GSAP's tool for responsive animations
    gsap.matchMedia().add({

        // Desktop screens (1025px and wider)
        isDesktop: "(min-width: 1025px)"

    }, (context) => {

        // The code inside this function will ONLY run on desktop.
        let { isDesktop } = context.conditions;

        if (isDesktop) {

            const footerParallaxTimeline = gsap.timeline({
                scrollTrigger: {
                    trigger: ".footer",
                    start: "top top",
                    end: "+=2000",
                    scrub: 2
                }
            });

            footerParallaxTimeline
                .fromTo(".layer-1", { y: 30 }, { y: 0 }, 0)
                .fromTo(".layer-2", { y: 70 }, { y: 0 }, 0)
                .fromTo(".layer-3", { y: 310 }, { y: 0 }, 0)
                .fromTo(".layer-5", { y: 340 }, { y: 0 }, 0)
                .fromTo(".footer-main-content", { y: 150 }, { y: -400, ease: "power1.out" }, 0);

            footerParallaxTimeline.fromTo(".layer-4 .figure-left",
                { x: "0" },
                {
                    x: "-100%",
                    ease: "none"
                },
                0
            );

            footerParallaxTimeline.fromTo(".layer-4 .figure-right",
                { x: "0" },
                {
                    x: "100%",
                    ease: "none"
                },
                0
            );
        }

        return () => {
            // GSAP's cleanup function automatically removes animations on browser resize.
        };
    });
});
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const logoImage = document.querySelector('.navbar .logo img');
    if (logoImage) {
        logoImage.addEventListener('click', () => {
            location.reload();
        });
    }
});
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    const landingPageContainer = document.getElementById('landing-page-container');
    const navbar = document.querySelector('.navbar');
    const originalNavbarParent = navbar.parentElement; // Store its original home (<header>)
    const scrollToTopBtn = document.getElementById('scrollToBottomBtn');

    if (!landingPageContainer || !navbar) return;

    const observer = new IntersectionObserver(
        (entries) => {
            entries.forEach(entry => {
                const isAnchored = navbar.classList.contains('navbar--anchored');

                if (!entry.isIntersecting && !isAnchored) {
                    // When scrolling past the landing page, ANCHOR the navbar
                    navbar.classList.add('navbar--anchored');
                    document.body.appendChild(navbar); // Move navbar to the <body>
                    scrollToTopBtn.classList.add('raised');
                } else if (entry.isIntersecting && isAnchored) {
                    // When scrolling back to the landing page, UN-ANCHOR it
                    navbar.classList.remove('navbar--anchored');
                    originalNavbarParent.appendChild(navbar); // Move it back to its original home
                    scrollToTopBtn.classList.remove('raised');
                }
            });
        },
        {
            rootMargin: "0px 0px -20px 0px",
            threshold: 0
        }
    );

    observer.observe(landingPageContainer);
});
</script>
<script>
    // 1. DEFINE VARIABLES IN GLOBAL SCOPE
    let lenis = null;

    // 2. ONLY LOAD/RUN IF ON DESKTOP
    // This prevents the script from even "thinking" on mobile
    if (window.innerWidth > 1024) {
        
        // Initialize Lenis
        lenis = new Lenis({
            duration: 1.5,
            easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
            smoothWheel: true,
            wheelMultiplier: 0.4,
            infinite: false,
        });

        // The animation loop only runs on Desktop
        function raf(time) {
            if (lenis) {
                lenis.raf(time);
                requestAnimationFrame(raf);
            }
        }
        requestAnimationFrame(raf);

        // Sync with your existing animations
        lenis.on('scroll', () => {
            if (typeof animationFrameId !== 'undefined' && !animationFrameId) {
                animationFrameId = requestAnimationFrame(runAnimations);
            }
        });
    } else {
        // MOBILE FALLBACK: 
        // Just use the standard native scroll for your Bus/Path animations
        window.addEventListener('scroll', () => {
            if (typeof animationFrameId !== 'undefined' && !animationFrameId) {
                animationFrameId = requestAnimationFrame(runAnimations);
            }
        }, { passive: true });
    }

    // 3. UNIFIED UI LOGIC (Safe for all devices)
    document.addEventListener('DOMContentLoaded', () => {
        const overlayButton = document.querySelector('.overlay-button');
        const scrollToTopBtn = document.getElementById('scrollToBottomBtn');
        const landingPage = document.getElementById('landing-page-container');

        // Scroll navigation that detects if Lenis is present
        const safeScroll = (target) => {
            if (lenis && window.innerWidth > 1024) {
                lenis.scrollTo(target, { duration: 1.5 });
            } else {
                target.scrollIntoView({ behavior: 'smooth' });
            }
        };

        if (overlayButton && landingPage) {
            overlayButton.addEventListener('click', (e) => {
                e.preventDefault();
                safeScroll(landingPage);
            });
        }

        if (scrollToTopBtn && landingPage) {
            scrollToTopBtn.addEventListener('click', (e) => {
                e.preventDefault();
                safeScroll(landingPage);
            });
        }
    });
</script>
<script>
    // --- GLOBAL VARIABLES & INITIAL SETUP ---
    const CACHE_KEY = 'path_cache_v1';
    const CACHE_TTL = 86400000; // 24 hours
    const MIN_SPLASH_DURATION = 1200; // Minimum 1.2-second splash screen duration

    const landingPage = document.getElementById('landing-page-container');
    const scrollToTopBtn = document.getElementById('scrollToBottomBtn');
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const topContentWrapper = document.querySelector('.top-content-wrapper');
    const dashedLineContainer = document.querySelector('.dashed-line');
    const svgTipCounter = document.getElementById('svg-tip-counter');
    const pathElement = document.getElementById('Line');
    const mobilePathElement = document.getElementById('mobile-line-path');
    const tabletPathElement = document.getElementById('tablet-line-path');
    const svgLine = document.querySelector(".dashed-line-center");
    const mobileSvgLine = document.getElementById('mobile-line-svg');
    const tabletSvgLine = document.getElementById('tablet-line-svg');
    const splashScreen = document.getElementById('splash-screen');
    const body = document.body;

    let pathTotalLength = 0;
    let mobilePathTotalLength = 0;
    let tabletPathTotalLength = 0;
    let checkpointsData = [];
    let animationFrameId = null;
    let lastRotationAngle = 90;

    let desktopPathCache = [];
    let mobilePathCache = [];
    let tabletPathCache = [];
    const CACHE_STEP = 3;

    // Tracks if the counter has been positioned for the first time
    let counterPositionedOnce = false;

    // --- CACHING UTILITY FUNCTIONS ---
    function loadPathCacheFromLocalStorage() {
        try {
            const cachedData = localStorage.getItem(CACHE_KEY);
            if (!cachedData) return false;

            const { data, timestamp } = JSON.parse(cachedData);
            if (Date.now() - timestamp > CACHE_TTL) {
                localStorage.removeItem(CACHE_KEY);
                return false;
            }

            // Restore available data
            desktopPathCache = data.desktop || [];
            mobilePathCache = data.mobile || [];
            tabletPathCache = data.tablet || [];

            const width = window.innerWidth;
            // VALIDATION: Only return true if the specific path needed for THIS device is ready
            if (width > 1024 && desktopPathCache.length > 0) {
                pathTotalLength = desktopPathCache.length * CACHE_STEP;
                return true;
            } 
            if (width <= 1024 && width > 600 && tabletPathCache.length > 0) {
                tabletPathTotalLength = tabletPathCache.length * CACHE_STEP;
                return true;
            }
            if (width <= 600 && mobilePathCache.length > 0) {
                mobilePathTotalLength = mobilePathCache.length * CACHE_STEP;
                return true;
            }
            return false; 
        } catch (e) { return false; }
    }

    // --- NEW: BACKGROUND CALCULATION FOR REMAINING DEVICES ---
    // function calculateMissingCaches() {
    //     const width = window.innerWidth;
    //     // Calculate Desktop if missing and not on desktop
    //     if (width <= 1024 && desktopPathCache.length === 0) {
    //         desktopPathCache = buildPathCache(pathElement, pathElement.getTotalLength());
    //     }
    //     // Calculate Tablet if missing and not on tablet
    //     if ((width > 1024 || width <= 600) && tabletPathCache.length === 0) {
    //         tabletPathCache = buildPathCache(tabletPathElement, tabletPathElement.getTotalLength());
    //     }
    //     // Calculate Mobile if missing and not on mobile
    //     if (width > 600 && mobilePathCache.length === 0) {
    //         mobilePathCache = buildPathCache(mobilePathElement, mobilePathElement.getTotalLength());
    //     }
    //     savePathCacheToLocalStorage(); // Final save of all three versions
    // }

    function savePathCacheToLocalStorage() {
        const data = {
            desktop: desktopPathCache,
            mobile: mobilePathCache,
            tablet: tabletPathCache,
        };
        const cacheEntry = {
            data: data,
            timestamp: Date.now(),
        };
        try {
            localStorage.setItem(CACHE_KEY, JSON.stringify(cacheEntry));
        } catch (e) {
            console.error('Error saving cache:', e);
        }
    }

    // --- CORE LOGIC FUNCTIONS ---
    function setupPathLengthsAndDasharrays() {
        const maskPath = document.getElementById('mask-path');
        const mobileMaskPath = document.getElementById('mobile-mask-path');
        const tabletMaskPath = document.getElementById('tablet-mask-path');

        if (pathElement && maskPath) {
            pathTotalLength = pathElement.getTotalLength();
            maskPath.style.strokeDasharray = pathTotalLength;
        }
        if (mobilePathElement && mobileMaskPath) {
            mobilePathTotalLength = mobilePathElement.getTotalLength();
            mobileMaskPath.style.strokeDasharray = mobilePathTotalLength;
        }
        if (tabletPathElement && tabletMaskPath) {
            tabletPathTotalLength = tabletPathElement.getTotalLength();
            tabletMaskPath.style.strokeDasharray = tabletPathTotalLength;
        }
    }

    function buildPathCache(path, pathLength) {
        if (!path || pathLength === 0) return [];

        const cache = [];
        for (let i = 0; i <= pathLength; i += CACHE_STEP) {
            const length = Math.min(i, pathLength);

            const currentPoint = path.getPointAtLength(length);
            const previousPoint = path.getPointAtLength(Math.max(0, length - 1));

            const angle = Math.atan2(currentPoint.y - previousPoint.y, currentPoint.x - previousPoint.x) * (180 / Math.PI);

            cache.push({ x: currentPoint.x, y: currentPoint.y, angle: angle + 90 });
        }
        return cache;
    }

    function updateMainCounter(currentIconYPosition) {
        if (!checkpointsData || checkpointsData.length === 0 || !svgTipCounter) return;

        let startCheckpoint = checkpointsData[0];
        let endCheckpoint = checkpointsData[0];

        for (let i = 0; i < checkpointsData.length - 1; i++) {
            if (currentIconYPosition >= checkpointsData[i].y && currentIconYPosition <= checkpointsData[i+1].y) {
                startCheckpoint = checkpointsData[i];
                endCheckpoint = checkpointsData[i+1];
                break;
            }
        }

        const scrollDistance = endCheckpoint.y - startCheckpoint.y;
        const altitudeRange = startCheckpoint.value - endCheckpoint.value;

        let progress = 0;
        if (scrollDistance > 0) {
            progress = (currentIconYPosition - startCheckpoint.y) / scrollDistance;
        }

        progress = Math.max(0, Math.min(1, progress));

        const currentValue = startCheckpoint.value - (progress * altitudeRange);

        const textElement = svgTipCounter.querySelector('.counter-text');

        if (textElement) {
            textElement.textContent = `${Math.round(Math.max(0, currentValue)).toLocaleString('en-US')} ft`;
        }
    }

    function animateAltitude(element) {
        const finalValue = parseInt(element.dataset.finalValue, 10);
        if (isNaN(finalValue) || element.dataset.animated) return;
        element.dataset.animated = 'true';
        const startValue = parseInt(element.textContent.replace(/,/g, ''), 10);
        const duration = 1500;
        let startTime = null;
        function step(timestamp) {
            if (!startTime) startTime = timestamp;
            const progress = Math.min((timestamp - startTime) / duration, 1);
            const easedProgress = 1 - Math.pow(1 - progress, 3);
            const currentValue = Math.floor(easedProgress * (finalValue - startValue) + startValue);
            element.textContent = currentValue.toLocaleString('en-US');
            if (progress < 1) {
                requestAnimationFrame(step);
            } else {
                element.textContent = finalValue.toLocaleString('en-US');
            }
        }
        requestAnimationFrame(step);
    }

    function updateNavLayout() {
        const isMobile = window.innerWidth <= 600;
        const navLeft = document.querySelector('.nav-left');
        const navRight = document.querySelector('.nav-right');
        if (isMobile) {
            if (navRight && navRight.children.length > 0) {
                while (navRight.firstElementChild) {
                    navLeft.appendChild(navRight.firstElementChild);
                }
            }
            if (navRight) navRight.style.display = 'none';
        } else {
            if (navRight) navRight.style.display = 'flex';
        }
    }

    function positionDashedLine() {
        if (window.innerWidth <= 1024) return;
        const stateContainer1 = document.querySelector('.state-container-1');
        const stateContainer12 = document.querySelector('.state-container-12');
        if (!stateContainer1 || !stateContainer12 || !topContentWrapper || !dashedLineContainer) return;
        const topContentWrapperRect = topContentWrapper.getBoundingClientRect();
        const state1Rect = stateContainer1.getBoundingClientRect();
        const state12Rect = stateContainer12.getBoundingClientRect();
        const offset = 0;
        const actualDashedLineTop = (state1Rect.top - topContentWrapperRect.top) - offset;
        const state12MiddleY =(state12Rect.bottom);
        const actualDashedLineHeight = (state12MiddleY - state1Rect.top);
        dashedLineContainer.style.top = `${actualDashedLineTop}px`;
        dashedLineContainer.style.height = `${actualDashedLineHeight}px`;
    }

    function positionMobileDashedLine() {
        if (window.innerWidth > 1024) return;
        const firstSection = document.querySelector('.state-container-1');
        const lastSection = document.querySelector('.state-container-12');
        if (!firstSection || !lastSection || !dashedLineContainer) return;
        const bottomOffset = -40;
        const topPosition = firstSection.offsetTop;
        const bottomPosition = lastSection.offsetTop + lastSection.offsetHeight + bottomOffset;
        const containerHeight = bottomPosition - topPosition;
        dashedLineContainer.style.top = `${topPosition}px`;
        dashedLineContainer.style.height = `${containerHeight}px`;
    }

    /** CORRECTED FIX: Prevents counter drop by only making it visible once positioned. */
    function updateCounterPosition(progress, pathLength, svg, pathCache) {
        if (!svgTipCounter || pathLength === 0 || !svg) return 0;

        const isVisible = (progress > 0.01 && progress < 0.99);

        const clampedDrawLength = Math.max(0, Math.min(progress * pathLength, pathLength));

        const cacheIndex = Math.floor(clampedDrawLength / CACHE_STEP);
        const cachedData = pathCache[cacheIndex] || pathCache[pathCache.length - 1] || {x: 0, y: 0, angle: 90};

        const currentPoint = { x: cachedData.x, y: cachedData.y };
        let totalRotation = cachedData.angle;

        let angleDifference = totalRotation - lastRotationAngle;
        if (angleDifference > 180) totalRotation -= 360;
        else if (angleDifference < -180) totalRotation += 360;
        lastRotationAngle = totalRotation;

        const svgRect = svg.getBoundingClientRect();
        let currentIconY = 0;

        if (svgRect.width > 0 && svgRect.height > 0) {
            const scaleY = svgRect.height / svg.viewBox.baseVal.height;
            const scaleX = svgRect.width / svg.viewBox.baseVal.width;
            const counterOffsetY = (svg !== svgLine) ? 30 : 0;

            const x = currentPoint.x * scaleX;
            const y = (currentPoint.y * scaleY) + counterOffsetY;

            svgTipCounter.style.transform = `translate3d(${x}px, ${y}px, 0) translate(-50%, -50%) rotate(${totalRotation}deg)`;
            currentIconY = dashedLineContainer.offsetTop + (currentPoint.y * scaleY);

            // Fix for initial drop: Set flag only if the position is calculated off top/left
            if (!counterPositionedOnce) {
                if (x !== 0 || y !== 0) {
                    counterPositionedOnce = true;
                }
            }
        }

        // Only manage opacity once the counter has been positioned at least once
        if (counterPositionedOnce) {
            svgTipCounter.style.opacity = isVisible ? '1' : '0';
        }

        return currentIconY;
    }

    function animateDashedLine() {
        const maskPath = document.getElementById('mask-path');
        if (window.innerWidth <= 1024 || !maskPath || pathTotalLength === 0) return 0;
        const animationStartScrollY = topContentWrapper.offsetTop;
        const animationScrollHeight = topContentWrapper.scrollHeight - window.innerHeight;
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        let linearProgress = 1 - ((scrollTop - animationStartScrollY) / animationScrollHeight);
        linearProgress = Math.max(0, Math.min(1, linearProgress));
        const modifiedProgress = Math.pow(linearProgress, 0.95);
        maskPath.style.strokeDashoffset = pathTotalLength - (pathTotalLength * modifiedProgress);
        return modifiedProgress;
    }

    function animateMobileDashedLine() {
        const mobileMaskPath = document.getElementById('mobile-mask-path');
        if (!mobileMaskPath || !mobilePathElement || mobilePathTotalLength === 0) return 0;
        const triggerPointY = window.innerHeight * 0.4;
        const svgRect = mobileSvgLine.getBoundingClientRect();
        if (svgRect.height === 0) return 0;
        const progress = 1 - ((triggerPointY - svgRect.top) / svgRect.height);
        const clampedProgress = Math.max(0, Math.min(1, progress));
        mobileMaskPath.style.strokeDashoffset = mobilePathTotalLength - (mobilePathTotalLength * clampedProgress);
        return clampedProgress;
    }

    function animateTabletDashedLine() {
        const tabletMaskPath = document.getElementById('tablet-mask-path');
        if (!tabletMaskPath || !tabletPathElement || tabletPathTotalLength === 0) return 0;
        const triggerPointY = window.innerHeight * 0.7;
        const svgRect = tabletSvgLine.getBoundingClientRect();
        if (svgRect.height === 0) return 0;
        const progress = 1 - ((triggerPointY - svgRect.top) / svgRect.height);
        const clampedProgress = Math.max(0, Math.min(1, progress));
        tabletMaskPath.style.strokeDashoffset = tabletPathTotalLength - (tabletPathTotalLength * clampedProgress);
        return clampedProgress;
    }

    function checkAndAnimatePopups() {
        const triggerThreshold = window.innerHeight * 0.20;
        document.querySelectorAll('.h2-popup').forEach(popup => {
            if (popup.classList.contains('visible')) return;
            const h2 = popup.nextElementSibling;
            if (!h2) return;
            const h2Rect = h2.getBoundingClientRect();
            if (h2Rect.bottom < 0 || h2Rect.top > window.innerHeight) return;
            const h2TriggerPoint = h2Rect.top + (h2Rect.height * 0.6);
            if (h2TriggerPoint > triggerThreshold) {
                popup.classList.add('visible');
                const altitudeValueElement = popup.querySelector('.altitude-value');
                if (altitudeValueElement) {
                    animateAltitude(altitudeValueElement);
                }
            }
        });
    }

    let lastTouchY = 0;
    let isBouncingTop = false;
    let isBouncingBottom = false;
    const scrollBlockingKeys = ['ArrowUp', 'ArrowDown', ' ', 'PageUp', 'PageDown'];

    function handleOverscroll(event) {
        if (window.innerWidth > 1024 || body.classList.contains('noscroll') || isBouncingTop || isBouncingBottom) return;
        const touchY = event.touches[0].clientY;
        const isScrollingUp = touchY > lastTouchY;
        const atTop = window.pageYOffset === 0;
        if (atTop && isScrollingUp && topContentWrapper) {
            event.preventDefault(); isBouncingTop = true; topContentWrapper.classList.add('pull-down-bounce-animation');
            setTimeout(() => { topContentWrapper.classList.remove('pull-down-bounce-animation'); isBouncingTop = false; }, 600);
        }
        const isScrollingDown = touchY < lastTouchY;
        const atBottom = Math.ceil(window.scrollY + window.innerHeight) >= document.documentElement.scrollHeight;
        if (atBottom && isScrollingDown && landingPage) {
            event.preventDefault(); isBouncingBottom = true; landingPage.classList.add('push-up-bounce-animation');
            setTimeout(() => { landingPage.classList.remove('push-up-bounce-animation'); isBouncingBottom = false; }, 600);
        }
        lastTouchY = touchY;
    }

    function preventKeyboardJump(e) {
        if (scrollBlockingKeys.includes(e.key)) e.preventDefault();
    }

    function runAnimations() {
        const screenWidth = window.innerWidth;
        let progress = 0;
        let currentIconY = 0;

        if (screenWidth > 1024) {
            progress = animateDashedLine();
            currentIconY = updateCounterPosition(progress, pathTotalLength, svgLine, desktopPathCache);
        }
        else if (screenWidth > 600) {
            progress = animateTabletDashedLine();
            currentIconY = updateCounterPosition(progress, tabletPathTotalLength, tabletSvgLine, tabletPathCache);
        }
        else {
            progress = animateMobileDashedLine();
            currentIconY = updateCounterPosition(progress, mobilePathTotalLength, mobileSvgLine, mobilePathCache);
        }

        updateMainCounter(currentIconY);
        checkAndAnimatePopups();
        animationFrameId = null;
    }

    function scrollFinalize() {
        // Remove scroll lock
        body.classList.remove('loading-active');

        // Final, definitive scroll to the bottom element's top edge
        setTimeout(() => {
            if (landingPage) landingPage.scrollIntoView({ behavior: 'instant' });
        }, 10);
    }

    //function to display the scroll up prompt

/* 
function showScrollTutorial() {
    const tutorial = document.getElementById('scroll-tutorial');
    if (!tutorial) return;

    // --- COOLDOWN LOGIC (30 Minutes) ---
    const COOLDOWN_MS = 30 * 60 * 1000; // 30 mins in milliseconds
    const lastSeen = localStorage.getItem('tutorialLastSeen');
    const now = Date.now();

    // If seen recently (less than 30 mins ago), hide and exit
    if (lastSeen && (now - lastSeen < COOLDOWN_MS)) {
        tutorial.style.display = 'none';
        return;
    }

    // 1. Show the element
    tutorial.style.display = 'flex';
    
    // 2. Force a reflow and fade in
    setTimeout(() => {
        tutorial.style.opacity = '1';
    }, 100);

    const dismissTutorial = () => {
        tutorial.style.opacity = '0';
        setTimeout(() => {
            tutorial.style.display = 'none';
            document.body.classList.remove('noscroll');
            
            // --- UPDATE TIMESTAMP ON DISMISS ---
            localStorage.setItem('tutorialLastSeen', Date.now());
        }, 800);

        window.removeEventListener('wheel', dismissTutorial);
        window.removeEventListener('touchstart', dismissTutorial);
    };

    // 3. Grace period before listening for scroll
    setTimeout(() => {
        window.addEventListener('wheel', dismissTutorial, { passive: true, once: true });
        window.addEventListener('touchstart', dismissTutorial, { passive: true, once: true });
    }, 1000);

    // 4. Auto-dismiss after 4 seconds total
    setTimeout(dismissTutorial, 3000);
}
*/

    function scrollFinalize() {
        // Unlock body from splash screen state
        document.body.classList.remove('loading-active');

        if (landingPage) {
            // Move to bottom instantly
            landingPage.scrollIntoView({ behavior: 'instant' });
            
            // Wait for the "snap" to settle before showing tutorial
            setTimeout(showScrollTutorial, 300);
        }
    }

    // ----------------------------------------------------
    // --- CRITICAL FIX: Asynchronous Initialization ---
    // ----------------------------------------------------
function initializeHeavyContent(startTime) {
    const isCacheLoaded = loadPathCacheFromLocalStorage();
    const width = window.innerWidth;
    const splashImg = document.getElementById('splash-image');

    // 1. Existing Path Calculation Logic
    if (!isCacheLoaded) {
        if (width > 1024) {
            pathTotalLength = pathElement.getTotalLength();
            desktopPathCache = buildPathCache(pathElement, pathTotalLength);
        } else if (width > 600) {
            tabletPathTotalLength = tabletPathElement.getTotalLength();
            tabletPathCache = buildPathCache(tabletPathElement, tabletPathTotalLength);
        } else {
            mobilePathTotalLength = mobilePathElement.getTotalLength();
            mobilePathCache = buildPathCache(mobilePathElement, mobilePathTotalLength);
        }
        savePathCacheToLocalStorage();
    }

    // Apply DashArrays
    const m = document.getElementById('mask-path'), tm = document.getElementById('tablet-mask-path'), mm = document.getElementById('mobile-mask-path');
    if(m) m.style.strokeDasharray = (desktopPathCache.length * CACHE_STEP) || pathElement.getTotalLength();
    if(tm) tm.style.strokeDasharray = (tabletPathCache.length * CACHE_STEP) || tabletPathElement.getTotalLength();
    if(mm) mm.style.strokeDasharray = (mobilePathCache.length * CACHE_STEP) || mobilePathElement.getTotalLength();

    // Setup Checkpoints
    const containers = document.querySelectorAll('.state-container');
    checkpointsData = [];
    containers.forEach(c => {
        const val = c.querySelector('.altitude-value');
        if (val) checkpointsData.push({ y: c.offsetTop, value: parseInt(val.dataset.finalValue) });
    });
    if (containers.length > 0) {
        const last = containers[containers.length-1];
        checkpointsData.push({ y: last.offsetTop + last.offsetHeight, value: 0 });
    }
    checkpointsData.sort((a, b) => a.y - b.y);

    if (width <= 1024) positionMobileDashedLine(); else positionDashedLine();
    runAnimations();
    updateNavLayout();

    // 2. PROGRESSIVE COLOR LOGIC
    const elapsed = performance.now() - startTime;
    const delay = isCacheLoaded ? 800 : Math.max(1500, MIN_SPLASH_DURATION - elapsed);
    
    let progress = 0;
    const intervalTime = 50; // Update every 50ms
    const step = 100 / (delay / intervalTime);

    const progressInterval = setInterval(() => {
        progress += step;
        if (progress >= 100) {
            progress = 100;
            clearInterval(progressInterval);
        }
        if (splashImg) {
            // Update the CSS variable
            splashImg.style.setProperty('--load-progress', progress + '%');
        }
    }, intervalTime);

    // 3. Close Splash
    setTimeout(() => {
        clearInterval(progressInterval); // Ensure it's cleared
        if (splashImg) splashImg.style.setProperty('--load-progress', '100%');
        
        if (splashScreen) splashScreen.classList.add('hidden');
        scrollFinalize();
        if (!isCacheLoaded || desktopPathCache.length === 0 || mobilePathCache.length === 0 || tabletPathCache.length === 0) {
            setTimeout(calculateMissingCaches, 1000);
        }
    }, delay);

    // Intersection Observer logic
    const isMobile = window.innerWidth <= 600;
    const observerOptions = { 
        root: null, 
        rootMargin: isMobile ? '0px 0px -10% 0px' : '0px 0px -25% 0px', 
        threshold: isMobile ? 0.2 : 0.6 
    };
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(e => { 
            if (e.isIntersecting) { 
                e.target.classList.add('is-visible'); 
                observer.unobserve(e.target); 
            } 
        });
    }, observerOptions);
    containers.forEach(c => observer.observe(c)); 
}

// --- EVENT LISTENERS & INITIALIZATION ---
    window.onload = () => {
        const startTime = performance.now(); // Start timer immediately on load

        // CRITICAL: Apply the scroll lock immediately on load
        body.classList.add('loading-active');

        // 1. Synchronous setup of SVG lengths
        setupPathLengthsAndDasharrays();

        // 2. DEFER THE HEAVY WORK
        const delay = loadPathCacheFromLocalStorage() ? 5 : 50;
        setTimeout(() => initializeHeavyContent(startTime), delay);
    };

    window.addEventListener('resize', () => {
        if (window.innerWidth <= 1024) {
            positionMobileDashedLine();
        } else {
            positionDashedLine();
        }
        runAnimations();
        updateNavLayout();
    });

    window.addEventListener('scroll', () => {
        if (!animationFrameId) {
            animationFrameId = requestAnimationFrame(runAnimations);
        }

        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const scrollableHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrollFraction = scrollableHeight > 0 ? (scrollTop / scrollableHeight) : 0;
        if (scrollFraction < 0.5) {
            scrollToTopBtn.classList.remove('is-hidden');
        } else {
            scrollToTopBtn.classList.add('is-hidden');
        }
    }, { passive: true });

    scrollToTopBtn.addEventListener('click', (e) => {
        e.preventDefault();
        if (landingPage) landingPage.scrollIntoView({ behavior: 'smooth' });
    });

    const navbar = document.querySelector('.navbar');
    mobileMenuToggle.addEventListener('click', () => {
        navbar.classList.toggle('nav-open');
        body.classList.toggle('noscroll');
        document.documentElement.classList.toggle('noscroll');
        scrollToTopBtn.classList.toggle('is-hidden-by-nav');
        const isExpanded = navbar.classList.contains('nav-open');
        mobileMenuToggle.setAttribute('aria-expanded', isExpanded);
        const icon = mobileMenuToggle.querySelector('i');
        icon.classList.toggle('fa-bars', !isExpanded);
        icon.classList.toggle('fa-times', isExpanded);
    });

    const overlayButton = document.querySelector('.overlay-button');
    if (overlayButton && landingPage) {
        overlayButton.addEventListener('click', (event) => {
            event.preventDefault();
            const targetScrollY = landingPage.offsetTop - window.innerHeight;
            window.scrollTo({ top: targetScrollY, behavior: 'smooth' });
        });
    }

    window.addEventListener('touchstart', (e) => {
        if (window.innerWidth <= 1024) { lastTouchY = e.touches[0].clientY; }
    }, { passive: true });

    window.addEventListener('touchmove', handleOverscroll, { passive: false });
    window.addEventListener('keydown', preventKeyboardJump, { passive: false });
    history.scrollRestoration = 'manual';
</script>
</body>
</html>