<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Himachalites</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style4.css">
    <link rel="icon" type="image/png" href="img/Frame 9.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&family=Shadows+Into+Light+Two&display=swap" rel="stylesheet"> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollToPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <style>
        body {
            opacity: 0;
            transition: opacity 0.4s ease-in;
        }
/* --- FINAL & CORRECTED CSS FOR SVG --- */

/* Hide mobile SVG on desktop by default */
#mobile-line-svg {
    display: none;
}

/* Rules for mobile screens (max-width: 1024px) */
@media (max-width: 1024px) {
    
    /* 1. Ensure the main wrapper remains a positioning context */
    .top-content-wrapper {
        position: relative !important;
    }
    
    /* 2. Set up the line container for JS positioning and place it ON TOP of content */
    .dashed-line {
        display: block !important;
        position: absolute !important;
        margin: 0 !important;
        
        /* Horizontally center the container */
        width: 90% !important; 
        max-width: 500px; 
        left: 50% !important;
        transform: translateX(-50%) !important;
        
        /* FIX: Set z-index to 1 to bring it in front of the content sections */
        z-index: 1; 
        /* Make it non-interactive so you can click/scroll through it */
        pointer-events: none; 
    }

    /* 3. Make sure the counter is on top of the line */
    #svg-tip-counter {
        /* FIX: Higher z-index than the line */
        z-index: 2; 
        pointer-events: all; 
    }

    /* --- Hide/Show Logic --- */
    
    /* 4. Hide the DESKTOP SVG */
    .dashed-line-center {
        display: none;
    }
    
    /* 5. Show the MOBILE SVG and ensure it fills its container */
    #mobile-line-svg {
        display: block;
        width: 100%;
        height: 100%; /* Fills the height set by the JS */
        position: absolute;
        top: 0;
        left: 0;
    }
}
        #scrollToBottomBtn.is-hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transform: scale(0.5);
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
        }
        .altitude-unit {
            font-weight: 500;
            margin-left: 0.2em;
        }
        
/* --- COUNTER STYLES --- */

/* 1. Main Container */
#svg-tip-counter {
    position: absolute;
    width: 120px;  /* Set the size of your icon */
    height: 120px;
    z-index: 10;
    opacity: 0;

    /* These styles are now applied to the container */
    transform: translate(-50%, -50%) rotate(0deg);
    transition: top 0.05s linear, 
                left 0.05s linear, 
                opacity 0.3s ease, 
                transform 0.1s linear;
}

/* 2. Background Image (the PNG) */
.counter-bg-image {
    width: 100%;
    height: 100%;
}

/* 3. The Altitude Text */
.counter-text {
    position: absolute;
    top: 50%; /* Center vertically */
    left: 50%; /* Center horizontally */
    transform: translate(-50%, 50%) rotate(90deg); /* Fine-tune centering */
    
    color: black; /* Text color */
    font-size: 14px; /* Text size */
    font-weight: 600;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    white-space: nowrap;
}

        /* --- ADDED FOR SCROLL-TRIGGERED ANIMATIONS --- */

        /* Initial state: elements are invisible and shifted */
/* --- SCROLL-TRIGGERED ANIMATIONS (NEW) --- */

/* Initial state: elements are invisible and blurred */
            .state-container .info-column > h2,
            .state-container .info-column > p,
            .state-container .info-column > .info-button {
                opacity: 0;
                /* The blur effect you wanted */
                filter: blur(10px); 
                /* Increased duration to 1s to match the React component's default */
                transition: opacity 0.6s ease-out, filter 0.6s ease-out; 
            }

            /* The old transform rules are no longer needed,
            so we can remove the entire '.state-container:not(.reverse)...'
            and '.state-container.reverse...' blocks.
            */

            /* These delays create the same staggered effect as before */
            .state-container .info-column > p {
                transition-delay: 0.1s;
            }
            .state-container .info-column > .info-button {
                transition-delay: 0.2s;
            }

            /* Final state: triggered by JS adding the 'is-visible' class */
            .state-container.is-visible .info-column > h2,
            .state-container.is-visible .info-column > p,
            .state-container.is-visible .info-column > .info-button {
                opacity: 1;
                /* Remove the blur on the final state */
                filter: blur(0px); 
                /* The old transform: translateX(0) is no longer needed */
            }
/* --- END OF NEW CSS --- */
        /* --- END OF ADDED CSS --- */
    </style>
</head>
<body>
    <div class="footer">
        <div class="footer-copyright">
            <p>Copyright &copy; 2025. Swaggytoon. All Rights Reserved.</p>
        </div>
        <div class="footer-main-content">
            <div class="footer-column">
                <h4>About US</h4>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Merch</a></li>
                    <li><a href="#">About</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Contact Info</h4>
                <ul>
                    <li><a href="#">Contact Us</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Social Connect</h4>
                <ul>
                    <li><a href="#">Instagram <i class="fa-brands fa-instagram"></i></a></li>
                    <li><a href="#">Youtube <i class="fa-brands fa-youtube"></i></a></li>
                    <li><a href="#">Facebook <i class="fa-brands fa-facebook"></i></a></li>
                </ul>
            </div>
        </div>
        <div class="parallax-backgrounds">
            <div class="parallax-layer layer-1">
                <img srcset="f/720px/Back Mountains.png 720w,
                    f/1080px/Back Mountains.png 1900w,
                    f/1440px/Back Mountains.png 2000w,
                    f/2160px/Back Mountains.png 3000w"
                    sizes="100vw"
                    src="f/1080px/Back Mountains.png" 
                    alt="Distant back mountains">
            </div>

            <div class="parallax-layer layer-2">
                <img srcset="f/720px/Front Mountains.png 720w,
                    f/1080px/Front Mountains.png 1900w,
                    f/1440px/Front Mountains.png 2000w,
                    f/2160px/Front Mountains.png 3000w"
                    sizes="100vw"
                    src="f/1080px/Front Mountains.png" 
                    alt="Closer front mountains">
            </div>

            <div class="parallax-layer layer-3">
                <img srcset="f/720px/Footer forest.png 720w,
                    f/1080px/Footer forest.png 1900w,
                    f/1440px/Footer forest.png 2000w,
                    f/2160px/Footer forest.png 3000w"
                    sizes="100vw"
                    src="f/1080px/Footer forest.png" 
                    alt="A dense forest line">
            </div>

            <div class="parallax-layer layer-4">
                <img class="figure-left"
                    srcset="f/1440px/Women.png 720w,
                    f/1440px/Women.png 1920w,
                    f/1440px/Women.png 2000w,
                    f/2160px/Women.png 3000w"
                    src="f/1080px/Women.png"
                    sizes="35vw" 
                    alt="Illustration of a woman">
                <img class="figure-right" 
                    srcset="f/1440px/Men.png 720w,
                    f/1440px/Men.png 1920w,
                    f/1440px/Men.png 2000w,
                    f/2160px/Men.png 3000w"
                    src="f/1080px/Men.png" 
                    sizes="35vw"
                    alt="Illustration of a man">
            </div>

            <div class="parallax-layer layer-5">
                <img srcset="f/720px/Bottom Clouds.png 720w,
                    f/1080px/Bottom Clouds.png 19200w,
                    f/1440px/Bottom Clouds.png 2000w,
                    f/2160px/Bottom Clouds.png 3000w"
                    src="f/1080px/Bottom Clouds.png" 
                    sizes="100vw"
                    alt="Layer of fog or clouds">
            </div>
        </div>
    </div>
    <!-- <div class="top-scroll-spacer"></div> -->
    <div class="top-content-wrapper">
        <div class="dashed-line">
            <div id="svg-tip-counter">
    <img class="counter-bg-image" src="img/Bus.png" alt="Path indicator arrow">
    <div class="counter-text">0 ft</div>
</div>
                <svg
                    class="dashed-line-center"
                    viewBox="0 0 1691 9131"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    role="img"
                    aria-labelledby="line-title"
                    preserveAspectRatio="none">
                    <title id="line-title">Decorative dashed line</title>

                    <defs>
                        <mask id="line-drawing-mask">
                            <path
                                id="mask-path"
                                d="M911 9133C911 9083.5 937.499 8875.8 872 8851C806.501 8826.2 808.924 8794.33 839 8724.5C847.076 8698.33 840.063 8620.8 749.5 8600C658.937 8579.2 587.063 8575.5 562 8563C509.367 8539.67 448.375 8528 601.095 8520C753.815 8512 785.474 8542.67 806.5 8540C821.104 8544.16 907.587 8566.39 997 8475C1059.47 8424.76 1154.32 8367.5 1356.5 8407C1405.79 8415.5 1417.13 8395.5 1466 8343C1486.72 8329.8 1568.5 8345 1613 8299.5C1643.5 8268.31 1585.6 8251.3 1613 8218.5C1647.25 8177.5 1720.95 8071 1679 7935C1655.61 7894 1643.12 7849.5 1595.5 7856C1552.73 7845.6 1556.72 7764 1535 7733.5C1522.33 7712.5 1402.59 7654.3 1303 7679.5C1178.52 7711 1073.62 7727.5 926.163 7632.5C803.353 7544 738.16 7598.5 477.5 7632.5C377.664 7640.5 56.3293 7698.5 25 7536.5C-0.0634441 7406.9 10.7721 7056 13 7001.5C27.4811 6936.67 123.632 6930.5 235.248 6934.5C335.084 6938 438.262 6913.5 505.516 6877.5C572.769 6841.5 613.706 6837 782.884 6877.5C952.063 6918 1077.38 6946 1436.62 6867.5C1465.03 6857.1 1504.99 6830.5 1521.42 6818.5C1527.41 6809.17 1548.91 6785.3 1587 6764.5C1634.62 6738.5 1682.24 6450.5 1664.7 6346C1647.16 6241.5 1635.04 6073 1469.62 6119C1349.32 6161.5 1277.89 6181.5 1085.73 6135.5C1026.92 6122.3 964.873 6108 941.202 6102.5C910.708 6079.83 836.353 6035.1 782.884 6037.5C716.048 6040.5 675.529 5978.5 735.264 5934.5C794.998 5890.5 874.784 5832 822.568 5763C770.353 5694 767.429 5661 805.859 5591C844.29 5521 822.986 5462 720.226 5493C619.137 5501.5 638.352 5452 710.618 5388.5C782.884 5334.5 920.315 5250 1298.77 5297.5C1358.93 5302.5 1681.6 5314.5 1663.5 5046C1648.51 4823.63 1654.39 4792.5 1631 4750C1607.61 4707.5 1537.5 4708.5 1401 4685.5C1315.98 4663.5 1332.89 4620.83 1298.77 4586.5C1273.15 4559.83 1168.1 4505 1063.5 4569C961.158 4606.5 903.189 4640.5 640.44 4613.5C522.141 4591.9 391 4546 303 4560C215 4574 106.671 4607.5 57.5 4538.5C8.3286 4469.5 63.5 4443.5 57.5 4406.5C51.6205 4370.24 3.99997 4386.5 3.99997 4317.5C3.99997 4257.5 63.728 4248.5 25 4198C4.09119 4170.74 -4 4040 82.1952 3985C114.778 3956 136.499 3926.5 137.752 3900.5C139.006 3874.5 168.246 3866 202.5 3861.5C229.902 3857.9 396.907 3896.67 490.478 3861.5C509.832 3856.17 544.42 3823.2 642 3836C737.575 3825.6 793.884 3789.83 819.644 3767C825.91 3756.33 916.723 3757.7 1039.37 3796.5C1200.61 3814.5 1584.23 3749 1659 3624C1699.45 3556.38 1638.32 3511.81 1634 3418.5C1630.33 3339.33 1677.39 3251.83 1659 3213C1618.03 3126.5 1504 3122.5 1405.5 3122.5C1258.13 3122.5 1272 3053.5 1111 3110C1075.91 3115 1022.86 3160.5 971.48 3042C930.376 2947.2 866 3024.5 792.492 2969C754 2908 741.446 2897.7 819.644 2814.5C917.391 2710.5 909.455 2670.5 844.29 2568C779.125 2465.5 493.884 2203.5 803 2148.5C981.117 2120.1 1163.5 2265.68 1464 2199C1563.14 2177 1754.26 2035.1 1651 1841.5C1616.25 1776.3 1590 1781 1541 1735.5C1501 1688 1569.58 1665.15 1584 1624.5C1600.5 1578 1548.5 1529.5 1452 1555C1384.5 1572.84 1341.56 1593.6 1316.5 1578C1291.44 1562.4 1243.5 1520 1175 1530.5C1065.5 1547.28 1055 1613.45 965.5 1518.5C891.98 1440.5 864.747 1450.5 767 1449C669.252 1447.5 715.107 1374.5 527.966 1373C340.826 1371.5 220.886 1430.5 167 1427C113.113 1423.5 -3.51266 1370 23.6394 1269.5C50.7915 1169 61.2346 1110.5 15.2849 1070C-21.4748 1037.6 22.5255 981.833 49.1206 958C66.8042 931 88.0525 879.9 31.5762 891.5C-17.214 883.5 11.2469 849.167 31.5762 833C60.1206 814.667 173.261 773 267.5 795C328.488 800 380.616 819 414.452 757C448.287 695 499.455 574.017 644.72 619.008C712.707 651.5 780.378 697 906.531 533C926.999 489 945.8 467.895 906.531 322C874.5 203 843 71.5 1139 1.5"
                                stroke="white"
                                stroke-width="5" />
                        </mask>
                    </defs>
                    
                    <path
                        id="Line"
                        mask="url(#line-drawing-mask)"
                        d="M911 9133C911 9083.5 937.499 8875.8 872 8851C806.501 8826.2 808.924 8794.33 839 8724.5C847.076 8698.33 840.063 8620.8 749.5 8600C658.937 8579.2 587.063 8575.5 562 8563C509.367 8539.67 448.375 8528 601.095 8520C753.815 8512 785.474 8542.67 806.5 8540C821.104 8544.16 907.587 8566.39 997 8475C1059.47 8424.76 1154.32 8367.5 1356.5 8407C1405.79 8415.5 1417.13 8395.5 1466 8343C1486.72 8329.8 1568.5 8345 1613 8299.5C1643.5 8268.31 1585.6 8251.3 1613 8218.5C1647.25 8177.5 1720.95 8071 1679 7935C1655.61 7894 1643.12 7849.5 1595.5 7856C1552.73 7845.6 1556.72 7764 1535 7733.5C1522.33 7712.5 1402.59 7654.3 1303 7679.5C1178.52 7711 1073.62 7727.5 926.163 7632.5C803.353 7544 738.16 7598.5 477.5 7632.5C377.664 7640.5 56.3293 7698.5 25 7536.5C-0.0634441 7406.9 10.7721 7056 13 7001.5C27.4811 6936.67 123.632 6930.5 235.248 6934.5C335.084 6938 438.262 6913.5 505.516 6877.5C572.769 6841.5 613.706 6837 782.884 6877.5C952.063 6918 1077.38 6946 1436.62 6867.5C1465.03 6857.1 1504.99 6830.5 1521.42 6818.5C1527.41 6809.17 1548.91 6785.3 1587 6764.5C1634.62 6738.5 1682.24 6450.5 1664.7 6346C1647.16 6241.5 1635.04 6073 1469.62 6119C1349.32 6161.5 1277.89 6181.5 1085.73 6135.5C1026.92 6122.3 964.873 6108 941.202 6102.5C910.708 6079.83 836.353 6035.1 782.884 6037.5C716.048 6040.5 675.529 5978.5 735.264 5934.5C794.998 5890.5 874.784 5832 822.568 5763C770.353 5694 767.429 5661 805.859 5591C844.29 5521 822.986 5462 720.226 5493C619.137 5501.5 638.352 5452 710.618 5388.5C782.884 5334.5 920.315 5250 1298.77 5297.5C1358.93 5302.5 1681.6 5314.5 1663.5 5046C1648.51 4823.63 1654.39 4792.5 1631 4750C1607.61 4707.5 1537.5 4708.5 1401 4685.5C1315.98 4663.5 1332.89 4620.83 1298.77 4586.5C1273.15 4559.83 1168.1 4505 1063.5 4569C961.158 4606.5 903.189 4640.5 640.44 4613.5C522.141 4591.9 391 4546 303 4560C215 4574 106.671 4607.5 57.5 4538.5C8.3286 4469.5 63.5 4443.5 57.5 4406.5C51.6205 4370.24 3.99997 4386.5 3.99997 4317.5C3.99997 4257.5 63.728 4248.5 25 4198C4.09119 4170.74 -4 4040 82.1952 3985C114.778 3956 136.499 3926.5 137.752 3900.5C139.006 3874.5 168.246 3866 202.5 3861.5C229.902 3857.9 396.907 3896.67 490.478 3861.5C509.832 3856.17 544.42 3823.2 642 3836C737.575 3825.6 793.884 3789.83 819.644 3767C825.91 3756.33 916.723 3757.7 1039.37 3796.5C1200.61 3814.5 1584.23 3749 1659 3624C1699.45 3556.38 1638.32 3511.81 1634 3418.5C1630.33 3339.33 1677.39 3251.83 1659 3213C1618.03 3126.5 1504 3122.5 1405.5 3122.5C1258.13 3122.5 1272 3053.5 1111 3110C1075.91 3115 1022.86 3160.5 971.48 3042C930.376 2947.2 866 3024.5 792.492 2969C754 2908 741.446 2897.7 819.644 2814.5C917.391 2710.5 909.455 2670.5 844.29 2568C779.125 2465.5 493.884 2203.5 803 2148.5C981.117 2120.1 1163.5 2265.68 1464 2199C1563.14 2177 1754.26 2035.1 1651 1841.5C1616.25 1776.3 1590 1781 1541 1735.5C1501 1688 1569.58 1665.15 1584 1624.5C1600.5 1578 1548.5 1529.5 1452 1555C1384.5 1572.84 1341.56 1593.6 1316.5 1578C1291.44 1562.4 1243.5 1520 1175 1530.5C1065.5 1547.28 1055 1613.45 965.5 1518.5C891.98 1440.5 864.747 1450.5 767 1449C669.252 1447.5 715.107 1374.5 527.966 1373C340.826 1371.5 220.886 1430.5 167 1427C113.113 1423.5 -3.51266 1370 23.6394 1269.5C50.7915 1169 61.2346 1110.5 15.2849 1070C-21.4748 1037.6 22.5255 981.833 49.1206 958C66.8042 931 88.0525 879.9 31.5762 891.5C-17.214 883.5 11.2469 849.167 31.5762 833C60.1206 814.667 173.261 773 267.5 795C328.488 800 380.616 819 414.452 757C448.287 695 499.455 574.017 644.72 619.008C712.707 651.5 780.378 697 906.531 533C926.999 489 945.8 467.895 906.531 322C874.5 203 843 71.5 1139 1.5"
                        stroke="black"
                        stroke-width="2"
                        stroke-dasharray="7 7" />
                </svg>
<svg id="mobile-line-svg" viewBox="0 0 398 10977" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
    
    <defs>
        <mask id="mobile-drawing-mask">
            <rect id="mobile-mask-rect" x="0" y="0" width="398" height="400" fill="white"/>
        </mask>
    </defs>
    <path id="mobile-line-path" 
          mask="url(#mobile-drawing-mask)"
d="M242.5 10830C286 10815 346 10788.5 361.5 10749.5C377 10710.5 388.5 10633.5 373 10559.5C359.594 10495.5 356 10381.5 184 10369C50.2771 10359.3 -6.5 10226.5 40 10144C83.5 10084.5 98 9956.02 255.5 9940C344 9931 404.563 9768.46 379 9654C345.5 9504 244 9420 181.5 9416.5C136.167 9411.17 22 9385 41 9304C62 9244.5 83.5001 9265.6 73.5001 9148C64.8334 9102 69.4001 9010.5 157 9012.5C234.333 9008 362 8980 375 8805C377.5 8710.84 390 8533.82 298 8510.5C116.5 8464.5 14.0001 8390.5 24.0001 8232.5C32.5001 8187 76.2001 8095.3 183 8092.5C316.5 8089 355 8045 361.5 7986.5C368 7928 329 7829 333.5 7786.5C338 7744 368 7699.5 361.5 7664C355 7628.5 327 7605.5 142.5 7577C90 7564 -1.39989 7551.8 31.0001 7419C39.3334 7377.83 68.6001 7289 119 7263C157.167 7243.33 255 7220.74 327.5 7177.5C355.167 7161 399.3 7094.1 354.5 6958.5C309.7 6822.9 307.5 6852.5 327 6783.5C331.82 6766.45 367.869 6700.86 264.5 6682C127.5 6657 25.5001 6642 39.5001 6576.5C53.5001 6511 72.0001 6427.5 136 6364.5C200 6301.5 335.5 6293 361.5 6178C387.5 6063 386 5927 304 5860C222 5793 -25.4999 5713.5 31.0001 5527C55.1668 5482.33 128.805 5441.71 240.5 5416.5C400 5380.5 387.5 5181 362.5 5082.5C355.167 5025.33 301.3 4940.7 194.5 4919.5C61 4893 -59.9999 4703 57.0001 4579C101 4545.17 196 4556.5 321 4530.5C390.5 4513 380.5 4458 351.5 4196C344.029 4128.5 367.928 4133.76 340.5 4080C328 4055.5 301.867 4040.7 241 4032C153.5 4019.5 163.5 4030 55.5 3937C-23.2177 3869.22 25.5001 3712.5 79.5001 3675C199.5 3579 342 3638.5 357 3512C364 3414 393 3245.5 317.5 3139.5C257.1 3054.7 169.5 3113.5 104 3082C38.5 3050.5 26.0001 3044.4 26.0001 2982C26.0001 2904 38.0001 2831 100.5 2795.5C148.478 2768.25 291.5 2795.5 337 2670.5C364.5 2492.5 399 2444.5 353 2310.5C319.473 2212.84 220.812 2226.39 145 2215C48.5 2200.5 12.5661 2148.64 18.5 2111C36 2000 16.0001 1897.17 101 1865.5C177.5 1837 372.5 1774.5 372.5 1548.5C372.5 1322.5 286.5 1283.5 179.5 1282C72.5001 1280.5 -20.4999 1050 57.0001 973.5C134.5 897 321 931.5 347 846C373 760.5 414.5 422.5 265.5 412.5C116.5 402.5 -48.3487 378.5 15.0001 175C74.1748 -15.0911 155 129 246.5 1"           
stroke="black" 
          stroke-width="2" 
          stroke-dasharray="7 7"/>
</svg>
        </div>

        <div class="state-content-sections">
            <section class="state-container state-container--split reverse state-container-1">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/ls-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="25069">24,569</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-1">Lahaul & Spiti</h2>
                    <p>Imagine a desert in the sky, that’s Lahaul & Spiti. Cold, vast, and deeply spiritual. While Spiti is more Buddhist and barren, Lahaul mixes Buddhist monasteries with Hindu villages. People here live with the seasons: they farm barley, cook thukpa and momos, wear heavy woollen chubas, and rely on butter tea to survive winter. Monasteries like Key and Tabo are over a thousand years old. The roads may be rough, but the silence is unforgettable. Every summer, the region opens for a few months and then the snow closes the gates again.
                    <br><b>Quick Facts:</b>
                    <br>• India’s least populated district.
                    <br>• Home to Key, Tabo, and world’s highest post office (Hikkim).
                    <br>• Cuisine includes barley roti, thukpa, and butter tea.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/lh.png" alt="Scenic view of Lahaul & Spiti">
                </div>
            </section>
            
            <section class="state-container state-container--split state-container-2">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/kinaur-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="22362">21,862</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-2">Kinnaur</h2>
                    <p>Kinnaur is quiet, and proudly so. Located near the Indo-Tibetan border, it’s where Hindu and Buddhist symbols share space,  temples with prayer flags, monks beside local devtas. The green Kinnauri cap and intricately patterned shawls are worn like identity badges. Locals eat buckwheat rotis, chulli oil (from apricots), angoori (a home-brewed wine), and siddu with ghee. Phulaich, the autumn flower festival, is one of the few times the valleys burst into collective celebration. The sacred Kinnaur Kailash peak stands guard over a people who’ve mastered quiet resilience.
                    <br><b>Quick Facts:</b>
                    <br>• Blends Hindu and Buddhist traditions.
                    <br>• Famous for apples, wool crafts, and chulli oil.
                    <br>• Phulaich celebrates flowers and local gods.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Kin.png" alt="Scenic view of Kinnaur">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-3">
                 <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/chamba-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="21759">21,259</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-3">Chamba</h2>
                    <p>Chamba is where Himachal’s traditions wear embroidery. Literally. The famous Chamba Rumal (hand-embroidered cloth) and luanchari (women’s full-length dress) are still part of weddings and melas. The town sits by the Ravi River, surrounded by old temples and older legends. Come Minjar Mela, the valley blooms with parades, folk songs, and yellow threads tied for a good harvest. Chukh, a fiery chilli chutney, lives in every kitchen. And if you head to Bharmour or Pangi, you’ll enter a tribal Himachal most people don’t even know exists.
                    <br><b>Quick Facts:</b>
                    <br>• Minjar Mela celebrates harvest and rivers.
                    <br>• Famous for Chamba Rumal, luanchari, and Chukh chutney.
                    <br>• Dham includes rajma madra, mahni, meethe chawal.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/cha.png" alt="Scenic view of Chamba">
                </div>
            </section>

            <section class="state-container state-container--split state-container-4">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/kullu-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="21138">20,638</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-4">Kullu</h2>
                    <p>Kullu isn’t just a valley, it’s a divine neighbourhood. Locals call it the Valley of Gods, because almost every village has its own deity, carried in palanquins during festivals like Dussehra, where gods meet like old friends. The district spans over 5,503 sq km, from the bustling town of Kullu to the quieter slopes of Banjar and Tirthan. Locals grow apples and eat siddu, laute, babru, khobli, and bhaddu dal with red rice. The woollen Kullvi cap is more than fashion, it’s pride. Trekking, rafting, temple rituals, or just sitting by the Beas, Kullu makes even stillness feel sacred.
                    <br><b>Quick Facts:</b>
                    <br>• Kullu Dussehra hosts over 200 local deities.
                    <br>• Famous for apple orchards, woollens, and shawls.
                    <br>• Known for red rice, siddu, laute, and bhaddu dal.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Kul.png" alt="Scenic view of Kullu">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-5">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/shimla-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="18069">17,569</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-5">Shimla</h2>
                    <p>Shimla might be the capital, but its soul lies beyond the Ridge. While tourists sip coffee on Mall Road, locals in Upper Shimla, Kotkhai, Rohru, Chopal grow apples, worship devtas, and cook food that feels like home: siddu, khobli, laute, pahadi rajma, and bhaddu dal. Shimla runs the state, most government offices are based here, but it also dances in the Summer Festival, where folk meets modern. The Himachali cap is worn with pride, especially in winter when the mist wraps every rooftop. Shimla isn’t one town, it’s a whole region in disguise.
                    <br><b>Quick Facts:</b>
                    <br>• Administrative heart of Himachal.
                    <br>• Upper Shimla is apple-rich and culturally distinct.
                    <br>• Traditional foods: siddu, bhaddu dal, red rice, khobli.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Shm.png" alt="Scenic view of Shimla">
                </div>
            </section>

            <section class="state-container state-container--split state-container-6">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/kangra-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="16341">15,841</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-6">Kangra</h2>
                    <p>Kangra is Himachal’s largest district and it feels like it. From tea gardens in Palampur to temples in Jwalamukhi to Tibetan chants in McLeodganj, Kangra carries many identities. It’s also the home of Kangra miniature paintings, handwoven shawls, and a dham that locals serve with pride: madra, khatta, sepud badi, and meethe chawal. People speak in Kangri, wear phiran-style shawls, and swirl to Jhamakra folk dance during fairs. Kangra doesn’t rush you, it spreads out like a canvas waiting to be explored.
                    <br><b>Quick Facts:</b>
                    <br>• Home to Kangra Fort and famous Shakti temples.
                    <br>• Kangra tea has a GI tag.
                    <br>• Kangri Dham includes madra, khatta, sepud badi.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Kang.png" alt="Scenic view of Kangra">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-7">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/sirmaur-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="11965">11,465</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-7">Sirmaur</h2>
                    <p>If Solan is the industry, Sirmaur is the orchard. This southeastern district is known as the Peach Bowl of India and come April, the hills blush pink with blossoms. Locals speak Sirmauri, cook patande (sweet pancakes), and wear simple headscarves called dhatu. At Renuka Ji Fair, crowds gather around the lake shaped like a reclining goddess. From citrus in Rajgarh to prayers in Paonta Sahib, Sirmaur blends farming and faith. Its dham isn’t as widely known, but the warmth in its villages makes every meal taste like a festival.
                    <br><b>Quick Facts:</b>
                    <br>• Known for peaches, citrus, and turmeric.
                    <br>• Renuka Ji is Himachal’s largest natural lake.
                    <br>• Folk music here is soft, devotional, and group-based.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/SIr.png" alt="Scenic view of Sirmaur">
                </div>
            </section>

            <section class="state-container state-container--split state-container-8">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/mandi-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="11123">10,623</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-8">Mandi</h2>
                    <p>If you could hear Himachal’s heartbeat, it might sound like temple bells from Mandi. Spread across the middle hills, Mandi is called Chhoti Kashi because it has more old temples than traffic lights. But it’s not just stone and silence during Shivratri, gods from 200+ villages arrive in palanquins for a week-long party. People speak Mandeali, wear woollen shawls called pattoos, and serve Mandeali Dham with sepud badi, madra, and khatta on leaf plates. Villages like Barot and Janjehli are green hideouts where faith meets forests. Mandi isn’t flashy it’s soulful.
                    <br><b>Quick Facts:</b>
                    <br>• Shivratri fair brings together 200+ local deities.
                    <br>• Dham includes sepud badi, madra, khatta.
                    <br>• One of the most culturally intact districts in Himachal.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Man.png" alt="Scenic view of Mandi">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-9">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/solan-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="8018">7,518</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-9">Solan</h2>
                    <p>Solan is Himachal’s multitasker. It grows mushrooms, brews beer, runs industries, and still finds time for a proper fair. The Shoolini Fair, named after the town’s guardian goddess, takes over the streets every June. People eat madra and ghee-soaked rotis, dress casually in cottons and shawls, and live in a climate that feels neither too cold nor too hot. From British-era Kasauli to factory-packed Baddi, Solan balances old charm with new ambition. It’s not a place you visit for Instagram, it’s a place you move to without realising when you fell for it.
                    <br><b>Quick Facts:</b> 
                    <br>• Called the Mushroom City of India. 
                    <br>• Home to one of India’s oldest breweries (since 1855).
                    <br>• Shoolini Fair is the cultural highlight of the year.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Sol.png" alt="Scenic view of Solan">
                </div>
            </section>

            <section class="state-container state-container--split state-container-10">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/bilaspur-icon(1).png" alt="District Icon">
                        <span class="altitude-value" data-final-value="6496">5,996</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-10">Bilaspur</h2>
                    <p>Bilaspur is Himachal’s only town that got built twice once on land, once above water. The original town was submerged in the 1950s to make way for Gobind Sagar Lake, created by the Bhakra Dam. Today, Bilaspur is where wrestlers gather for the Nalwari Fair, and locals serve Dham with fennel-spiced chana dal, mah dal, and saffron rice. Fishing and boating are part of daily life. Naina Devi Temple, high above the lake, watches over the hills like a guardian. Bilaspur might be small, but it has stories above and below the waterline.
                    <br><b>Quick Facts:</b>
                    <br>• Gobind Sagar is one of India’s largest man-made lakes.
                    <br>• Nalwari Mela is a unique blend of cattle trade and culture.
                    <br>• Famous for Bilaspuri Dham and Naina Devi Temple.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Bil.png" alt="Scenic view of Bilaspur">
                </div>
            </section>

            <section class="state-container state-container--split reverse state-container-11">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/hamirpur-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="4101">3,601</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-11">Hamirpur</h2>
                    <p>Hamirpur doesn't show off  it simply delivers. Known as Veer Bhumi, this district sends more soldiers to the Indian Army per capita than most in the country. It’s also the most literate district in Himachal. You won’t see apple orchards or snowy peaks here  just warm hills, tightly-knit villages, and the sound of jheras (folk ballads) echoing at fairs. The Hamirpuri Dham is bold and earthy rice, mustard-oil madra, smoky mah dal, tangy apricot khatta, and sweet boondi. People wear light woollens and a shawl called chaddru, especially elders sipping tea on their verandahs. It's not touristy, and that's exactly the charm.
                    <br><b>Quick Facts:</b>
                    <br>• Highest literacy rate in Himachal.
                    <br>• Known for Hamirpuri Dham and Baba Balak Nath temple.
                    <br>• Folk music: Jheras, often sung in village gatherings and fairs.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column">
                    <img src="img/Hamir.png" alt="Scenic view of Hamirpur">
                </div>
            </section>

            <section class="state-container state-container--split state-container-12">
                <div class="info-column">
                    <div class="h2-popup">
                        <img src="icons/una-icon.png" alt="District Icon">
                        <span class="altitude-value" data-final-value="3937">3,437</span><span class="altitude-unit"> ft</span>
                    </div>
                    <h2 class="header-12">Una</h2>
                    <p>If Himachal were a house, Una would be the front gate. This southwestern district links the Punjab plains to the Himachali hills and you feel it in the air. It’s warmer, wheat grows instead of apples, and people say “Sat Sri Akal” as often as “Namaste.” Locals wear dupattas and shawls, and the rhythm of life leans towards dhol beats. At the heart is Chintpurni Temple, one of the major Shakti Peeths, drawing pilgrims year-round. Una’s roads are wide, rail lines broad, and energy unmistakably transitional it's Himachal's handshake to the rest of India.
                    <br><b>Quick Facts:</b>
                    <br>• One of the few Himachali districts with a broad-gauge rail line.
                    <br>• Chintpurni Temple attracts lakhs of devotees.
                    <br>• More Punjabi in flavour — in both food and weather.</p>
                    <a href="#" class="info-button">Explore</a>
                </div>
                <div class="image-column image-12">
                    <img src="img/Una.png" alt="Scenic view of Una">
                </div>
            </section>
        </div> 
        </div> 
    <div class="top-scroll-spacer"></div>
<div id="landing-page-container">
        <header>
            <div class="top-bar">
                <p>Keep Himalayas Clean & Plastic Free</p>
                <div class="social-links">
                    <a href="#" aria-label="YouTube"><i class="fa-brands fa-youtube"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook"></i></a>
                </div>
            </div>
            <nav class="navbar">
                <ul class="main-nav nav-left">
                    <li><a href="#" class="active">Home</a></li>
                    <li><a href="#">Merch</a></li>

                </ul>
                <div class="logo">
                    <img src="img/Frame 9.png" alt="Himachalites Logo">
                </div>
                <ul class="main-nav nav-right">
                    <li><a href="about.html">About</a></li>

                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
                <button class="mobile-menu-button" id="mobile-menu-toggle" aria-label="Toggle Menu" aria-expanded="false">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </header>

        <main class="content-area">
            <div class="overlay-content">
                <img src="img/Group 6.png" class="overlay-image" alt="Descriptive text">
            </div>
        </main>
        <button class="overlay-button">
            <span class="button-arrows">
                <svg class="button-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <g fill="none">
                        <path d="M0 0h24v24H0z"/>
                        <path fill="currentColor" d="m11.226 8.358l-4.01 4.01a.75.75 0 1 1-1.06-1.06l4.54-4.54a.75.75 0 0 1 1.06 0l4.54 4.54a.75.75 0 0 1-1.06 1.06l-4.01-4.01Zm0 5.656l-4.01 4.01a.75.75 0 1 1-1.06-1.06l4.54-4.54a.75.75 0 0 1 1.06 0l4.54 4.54a.75.75 0 0 1-1.06 1.06l-4.01-4.01Z"/>
                    </g>
                </svg>
            </span>
            <span class="button-text">Take the Road Home.</span>
        </button>
    </div>

    <a href="#landing-page-container" id="scrollToBottomBtn" title="Go to Landing Page">
        <i class="fas fa-arrow-down"></i>
    </a>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // 1. Find all the footer columns on the page
    const footerColumns = document.querySelectorAll('.footer-column');

    // 2. Loop through each column to set up the hover effect
    footerColumns.forEach(column => {
        
        // Find the h4 and ul elements within this specific column
        const heading = column.querySelector('h4');
        const list = column.querySelector('ul');

        // Make sure both elements exist before adding listeners
        if (heading && list) {

            // 3. When the mouse enters the list area...
            list.addEventListener('mouseenter', () => {
                // ...add the 'is-active' class to the heading.
                heading.classList.add('is-active');
            });

            // 4. When the mouse leaves the list area...
            list.addEventListener('mouseleave', () => {
                // ...remove the 'is-active' class from the heading.
                heading.classList.remove('is-active');
            });
        }
    });

});
</script>    
<script>
document.addEventListener("DOMContentLoaded", () => {
    // Ensure GSAP and ScrollTrigger are loaded
    if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {
        console.error("GSAP or ScrollTrigger not loaded!");
        return;
    }
    gsap.registerPlugin(ScrollTrigger);

    // Use GSAP's built-in tool for responsive animations
    gsap.matchMedia().add({
        
        // This condition is for desktop screens (769px and wider)
        isDesktop: "(min-width: 769px)"

    }, (context) => {

        // The code inside this function will ONLY run on desktop.
        let { isDesktop } = context.conditions;

        if (isDesktop) {
            
            // --- YOUR ENTIRE ANIMATION SCRIPT IS PLACED HERE ---

            const footerParallaxTimeline = gsap.timeline({
                scrollTrigger: {
                    trigger: ".footer",
                    start: "top top",
                    end: "bottom bottom",
                    scrub: 2 
                }
            });
            
            footerParallaxTimeline
                .fromTo(".layer-1", { y: 50 }, { y: 0 }, 0)
                .fromTo(".layer-2", { y: 90 }, { y: 0 }, 0)
                .fromTo(".layer-3", { y: 300 }, { y: -100 }, 0)
                .fromTo(".layer-5", { y: 350 }, { y: -100 }, 0)
                .fromTo(".footer-main-content", { y: 150 }, { y: -400, ease: "power1.out" }, 0);

            footerParallaxTimeline.fromTo(".layer-4 .figure-left",
                { x: "0" },
                { 
                    x: "-100%",
                    ease: "none"
                },
                0
            );

            footerParallaxTimeline.fromTo(".layer-4 .figure-right",
                { x: "0" },
                { 
                    x: "100%",
                    ease: "none"
                },
                0
            );
        }
        
        // --- On mobile screens (768px or less), none of the code above will run. ---

        return () => {
            // This is GSAP's cleanup function. It will automatically remove the
            // animations if you resize your browser from desktop to mobile.
        };
    });
});
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Find the logo image in the navbar
    const logoImage = document.querySelector('.navbar .logo img');

    // If the logo exists, add a click event listener
    if (logoImage) {
        logoImage.addEventListener('click', () => {
            // Reload the current page
            location.reload();
        });
    }
});
</script>
<script>
    // --- VARIABLE DECLARATIONS ---
    const navbar = document.querySelector('.navbar');
    const landingPage = document.getElementById('landing-page-container');
    const scrollToTopBtn = document.getElementById('scrollToBottomBtn');
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const svgLine = document.querySelector(".dashed-line-center");
    const topContentWrapper = document.querySelector('.top-content-wrapper');
    const dashedLineContainer = document.querySelector('.dashed-line');
    const stateContainers = document.querySelectorAll('.state-container');
    let lastScrollTop = 0;
    let isSlowing = false;
    let lastTouchY = 0;
    const scrollBlockingKeys = ['ArrowUp', 'ArrowDown', ' ', 'PageUp', 'PageDown'];
    let isBouncingTop = false;
    let isBouncingBottom = false;
    const svgTipCounter = document.getElementById('svg-tip-counter');
    const pathElement = document.getElementById('Line');
    let pathTotalLength = 0;
    let lastRotationAngle = 90;
    let checkpointsData = [];
    let maskPath = document.getElementById('mask-path');

    // --- NEW VARIABLES FOR MOBILE SVG ---
    const mobileSvgLine = document.getElementById('mobile-line-svg');
    const mobilePathElement = document.getElementById('mobile-line-path'); 
    const mobileMaskRect = document.getElementById('mobile-mask-rect'); 
    let mobilePathTotalLength = 0;
    let mobilePathMap = [];
    let animationFrameId = null;


    // --- FUNCTION DEFINITIONS ---

    function buildMobilePathMap() {
        if (!mobilePathElement) return;
        mobilePathTotalLength = mobilePathElement.getTotalLength();
        mobilePathMap = [];
        const step = 25; // Precision of the map.
        let lastPoint = mobilePathElement.getPointAtLength(0);

        for (let l = step; l <= mobilePathTotalLength; l += step) {
            const point = mobilePathElement.getPointAtLength(l);
            const angle = Math.atan2(point.y - lastPoint.y, point.x - lastPoint.x) * (180 / Math.PI);
            mobilePathMap.push({
                length: l,
                x: point.x,
                y: point.y,
                angle: angle
            });
            lastPoint = point;
        }
    }

    /** Updates the main altitude counter. */
    function updateMainCounter(currentIconYPosition) {
        if (!checkpointsData || checkpointsData.length === 0 || !svgTipCounter) return;
        let prevCheckpoint = checkpointsData[0];
        let nextCheckpoint = checkpointsData[checkpointsData.length - 1];
        for (let i = 0; i < checkpointsData.length - 1; i++) {
            if (checkpointsData[i].y >= currentIconYPosition && checkpointsData[i + 1].y <= currentIconYPosition) {
                prevCheckpoint = checkpointsData[i + 1];
                nextCheckpoint = checkpointsData[i];
                break;
            }
        }
        const distanceBetweenPoints = nextCheckpoint.y - prevCheckpoint.y;
        const valueRange = nextCheckpoint.value - prevCheckpoint.value;
        let progress = (distanceBetweenPoints !== 0) ? (currentIconYPosition - prevCheckpoint.y) / distanceBetweenPoints : 0;
        const currentValue = prevCheckpoint.value + (progress * valueRange);
        const textElement = svgTipCounter.querySelector('.counter-text');
        if (textElement) {
            textElement.textContent = `${Math.round(Math.max(0, currentValue)).toLocaleString('en-US')} ft`;
        }
    }

    /** Animates altitude popups. */
    function animateAltitude(element) {
        const finalValue = parseInt(element.dataset.finalValue, 10);
        if (isNaN(finalValue) || element.dataset.animated) return;
        element.dataset.animated = 'true';
        const startValue = parseInt(element.textContent.replace(/,/g, ''), 10);
        const duration = 1500;
        let startTime = null;
        function step(timestamp) {
            if (!startTime) startTime = timestamp;
            const progress = Math.min((timestamp - startTime) / duration, 1);
            const easedProgress = 1 - Math.pow(1 - progress, 3);
            const currentValue = Math.floor(easedProgress * (finalValue - startValue) + startValue);
            element.textContent = currentValue.toLocaleString('en-US');
            if (progress < 1) {
                requestAnimationFrame(step);
            } else {
                element.textContent = finalValue.toLocaleString('en-US');
            }
        }
        requestAnimationFrame(step);
    }
    
    /** Rearranges navigation links for mobile/desktop. */
    function updateNavLayout() {
        const isMobile = window.innerWidth <= 1024;
        const navLeft = document.querySelector('.nav-left');
        const navRight = document.querySelector('.nav-right');
        if (isMobile) {
            if (navRight && navRight.children.length > 0) {
                while (navRight.firstElementChild) {
                    navLeft.appendChild(navRight.firstElementChild);
                }
            }
            if (navRight) navRight.style.display = 'none';
        } else {
            if (navRight) navRight.style.display = 'flex';
        }
    }

    /** (ORIGINAL & UNTOUCHED) Positions the dashed line container on DESKTOP. */
    function positionDashedLine() {
        if (window.innerWidth <= 1024) return;
        const stateContainer1 = document.querySelector('.state-container-1');
        const stateContainer12 = document.querySelector('.state-container-12');
        if (!stateContainer1 || !stateContainer12 || !topContentWrapper || !dashedLineContainer) return;
        const topContentWrapperRect = topContentWrapper.getBoundingClientRect();
        const state1Rect = stateContainer1.getBoundingClientRect();
        const state12Rect = stateContainer12.getBoundingClientRect();
        const offset = 0;
        const actualDashedLineTop = (state1Rect.top - topContentWrapperRect.top) - offset;
        const state12MiddleY =(state12Rect.bottom);
        const actualDashedLineHeight = (state12MiddleY - state1Rect.top);
        dashedLineContainer.style.top = `${actualDashedLineTop}px`;
        dashedLineContainer.style.height = `${actualDashedLineHeight}px`;
    }

    /** (ORIGINAL & UNTOUCHED) Animates the SVG line and icon for DESKTOP view. */
    function animateDashedLine() {
        if (window.innerWidth <= 1024 || !maskPath || pathTotalLength === 0) {
            if (svgTipCounter) svgTipCounter.style.opacity = '0';
            return 0;
        }
        const animationStartScrollY = topContentWrapper.offsetTop;
        const animationScrollHeight = topContentWrapper.scrollHeight - window.innerHeight;
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const scrollAmountInAnimation = scrollTop - animationStartScrollY;
        let linearProgress = 1 - (scrollAmountInAnimation / animationScrollHeight);
        linearProgress = Math.max(0, Math.min(1, linearProgress));
        const modifiedProgress = Math.pow(linearProgress, 0.95);
        const drawLength = pathTotalLength * modifiedProgress;
        maskPath.style.strokeDashoffset = pathTotalLength - drawLength;
        if (svgTipCounter) {
            const shouldBeVisible = modifiedProgress > 0.01 && modifiedProgress < 0.99;
            svgTipCounter.style.opacity = shouldBeVisible ? '1' : '0';
            const clampedDrawLength = Math.max(1, Math.min(drawLength, pathTotalLength - 1));
            const currentPoint = pathElement.getPointAtLength(clampedDrawLength);
            const previousPoint = pathElement.getPointAtLength(clampedDrawLength - 1);
            const angle = Math.atan2(currentPoint.y - previousPoint.y, currentPoint.x - previousPoint.x) * (180 / Math.PI);
            const rotationOffset = 90;
            let totalRotation = angle + rotationOffset;
            let angleDifference = totalRotation - lastRotationAngle;
            if (angleDifference > 180) totalRotation -= 360;
            else if (angleDifference < -180) totalRotation += 360;
            lastRotationAngle = totalRotation;
            const svgLineRect = svgLine.getBoundingClientRect();
            if (svgLineRect.width > 0 && svgLineRect.height > 0) {
                const scaleY = svgLineRect.height / svgLine.viewBox.baseVal.height;
                const scaleX = svgLineRect.width / svgLine.viewBox.baseVal.width;
                svgTipCounter.style.left = `${currentPoint.x * scaleX}px`;
                svgTipCounter.style.top = `${currentPoint.y * scaleY}px`;
                svgTipCounter.style.transform = `translate(-50%, -50%) rotate(${totalRotation}deg)`;
                return dashedLineContainer.offsetTop + (currentPoint.y * scaleY);
            }
        }
        return 0;
    }

    /** Positions the line on MOBILE with your custom offset. */
    function positionMobileDashedLine() {
        if (window.innerWidth > 1024 || !dashedLineContainer) return;
        const firstSection = document.querySelector('.state-container-1');
        const lastSection = document.querySelector('.state-container-12');
        if (!firstSection || !lastSection) return;
        const bottomOffset = 170; 
        const topPosition = firstSection.offsetTop;
        const bottomPosition = lastSection.offsetTop + lastSection.offsetHeight + bottomOffset;
        const containerHeight = bottomPosition - topPosition;
        dashedLineContainer.style.top = `${topPosition}px`;
        dashedLineContainer.style.height = `${containerHeight}px`;
    }
    
    /** Final, OPTIMIZED function for the "top clip" MOBILE animation. */
    function animateMobileDashedLine() {
        if (!mobileMaskRect || !mobilePathElement || mobilePathMap.length === 0) {
            if (svgTipCounter) svgTipCounter.style.opacity = '0';
            return 0;
        }

        const counterOffsetY = 30;
        const clipPointY = window.innerHeight * 0.3;
        const svgRect = mobileSvgLine.getBoundingClientRect();
        if (svgRect.height === 0) return 0;

        const relativeClipY_px = clipPointY - svgRect.top;
        const viewboxHeight = mobileSvgLine.viewBox.baseVal.height;
        const scaleY = viewboxHeight / svgRect.height;
        const maskStartY_svg = relativeClipY_px * scaleY;
        const maskHeight_svg = viewboxHeight - maskStartY_svg;

        mobileMaskRect.setAttribute('y', maskStartY_svg);
        mobileMaskRect.setAttribute('height', Math.max(0, maskHeight_svg));

        if (svgTipCounter) {
            const isVisible = (relativeClipY_px > 0 && relativeClipY_px < svgRect.height);
            svgTipCounter.style.opacity = isVisible ? '1' : '0';
            
            let bestLength = 0;
            let minDiff = Infinity;
            for (const point of mobilePathMap) {
                const diff = Math.abs(point.y - maskStartY_svg);
                if (diff < minDiff) {
                    minDiff = diff;
                    bestLength = point.length;
                }
            }
            const currentLength = bestLength;
            
            const currentPoint = mobilePathElement.getPointAtLength(currentLength);
            const previousPoint = mobilePathElement.getPointAtLength(currentLength > 0 ? currentLength - 1 : 0);
            const angle = Math.atan2(currentPoint.y - previousPoint.y, currentPoint.x - previousPoint.x) * (180 / Math.PI);
            const rotationOffset = 90;
            let totalRotation = angle + rotationOffset;
            let angleDifference = totalRotation - lastRotationAngle;
            if (angleDifference > 180) totalRotation -= 360;
            else if (angleDifference < -180) totalRotation += 360;
            lastRotationAngle = totalRotation;
            
            const pointScaleX = svgRect.width / mobileSvgLine.viewBox.baseVal.width;
            const pointScaleY = svgRect.height / mobileSvgLine.viewBox.baseVal.height;
            
            const counterLeft = currentPoint.x * pointScaleX;
            const counterTop = (currentPoint.y * pointScaleY) + counterOffsetY;

            svgTipCounter.style.left = `${counterLeft}px`;
            svgTipCounter.style.top = `${counterTop}px`;
            svgTipCounter.style.transform = `translate(-50%, -50%) rotate(${totalRotation}deg)`;

            return dashedLineContainer.offsetTop + (currentPoint.y * pointScaleY);
        }
        return 0;
    }

    function checkAndAnimatePopups() {
        const triggerThreshold = window.innerHeight * 0.20;
        document.querySelectorAll('.h2-popup').forEach(popup => {
            if (popup.classList.contains('visible')) return;
            const h2 = popup.nextElementSibling;
            if (!h2) return;
            const h2Rect = h2.getBoundingClientRect();
            if (h2Rect.bottom < 0 || h2Rect.top > window.innerHeight) return;
            const h2TriggerPoint = h2Rect.top + (h2Rect.height * 0.6);
            if (h2TriggerPoint > triggerThreshold) {
                popup.classList.add('visible');
                const altitudeValueElement = popup.querySelector('.altitude-value');
                if (altitudeValueElement) {
                    animateAltitude(altitudeValueElement);
                }
            }
        });
    }

    function handleOverscroll(event) {
        if (window.innerWidth > 1024 || document.body.classList.contains('noscroll') || isBouncingTop || isBouncingBottom) return;
        const touchY = event.touches[0].clientY;
        const isScrollingUp = touchY > lastTouchY;
        const atTop = window.pageYOffset === 0;
        if (atTop && isScrollingUp && topContentWrapper) {
            event.preventDefault(); isBouncingTop = true; topContentWrapper.classList.add('pull-down-bounce-animation');
            setTimeout(() => { topContentWrapper.classList.remove('pull-down-bounce-animation'); isBouncingTop = false; }, 600);
        }
        const isScrollingDown = touchY < lastTouchY;
        const atBottom = Math.ceil(window.scrollY + window.innerHeight) >= document.documentElement.scrollHeight;
        if (atBottom && isScrollingDown && landingPage) {
            event.preventDefault(); isBouncingBottom = true; landingPage.classList.add('push-up-bounce-animation');
            setTimeout(() => { landingPage.classList.remove('push-up-bounce-animation'); isBouncingBottom = false; }, 600);
        }
        lastTouchY = touchY;
    }

    function preventKeyboardJump(e) {
        if (isSlowing && scrollBlockingKeys.includes(e.key)) e.preventDefault();
    }


    // --- MAIN ANIMATION LOOP (for performance) ---
    function runAnimations() {
        let currentIconY = 0;
        if (window.innerWidth <= 1024) {
            currentIconY = animateMobileDashedLine();
        } else {
            currentIconY = animateDashedLine();
        }
        updateMainCounter(currentIconY);
        checkAndAnimatePopups();
        animationFrameId = null;
    }


    // --- EVENT LISTENERS ---
    window.onload = () => {
        if (landingPage) landingPage.scrollIntoView({ behavior: 'instant' });
        
        if (pathElement && maskPath) {
            pathTotalLength = pathElement.getTotalLength();
            maskPath.style.strokeDasharray = pathTotalLength;
            maskPath.style.strokeDashoffset = pathTotalLength;
        }

        buildMobilePathMap();

        const allStateContainers = document.querySelectorAll('.state-container');
        if (allStateContainers.length > 0) {
            const lastContainer = allStateContainers[allStateContainers.length - 1];
            checkpointsData.push({ y: lastContainer.offsetTop + lastContainer.offsetHeight, value: 0 });
        }
        allStateContainers.forEach(container => {
            const valueElement = container.querySelector('.altitude-value');
            if (valueElement && valueElement.dataset.finalValue) {
                const value = parseInt(valueElement.dataset.finalValue, 10);
                checkpointsData.push({ y: container.offsetTop, value: value });
            }
        });
        checkpointsData.sort((a, b) => a.y - b.y);
        
        document.body.style.opacity = '1';
        
        if (window.innerWidth <= 1024) {
            positionMobileDashedLine();
        } else {
            positionDashedLine();
        }
        runAnimations();
        
        updateNavLayout();

        const observerOptions = { root: null, rootMargin: '0px 0px -20% 0px', threshold: 0.25 };
        const observerCallback = (entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        };
        const scrollObserver = new IntersectionObserver(observerCallback, observerOptions);
        document.querySelectorAll('.state-container').forEach(container => scrollObserver.observe(container));
    };

    window.addEventListener('resize', () => {
        if (window.innerWidth <= 1024) {
            positionMobileDashedLine();
            buildMobilePathMap();
        } else {
            positionDashedLine();
        }
        runAnimations();
        updateNavLayout();
    });

    window.addEventListener('scroll', () => {
        if (!animationFrameId) {
            animationFrameId = requestAnimationFrame(runAnimations);
        }
        
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        if (landingPage) {
            const anchorThreshold = 0.90;
            const bottomOfViewport = scrollTop + window.innerHeight;
            const topOfLandingPage = landingPage.offsetTop;
            const heightOfLandingPage = landingPage.offsetHeight;
            const triggerPoint = topOfLandingPage + (heightOfLandingPage * (1 - anchorThreshold));
            if (bottomOfViewport < triggerPoint) {
                navbar.classList.add('navbar--anchored');
                scrollToTopBtn.classList.add('raised');
            } else {
                navbar.classList.remove('navbar--anchored');
                scrollToTopBtn.classList.remove('raised');
            }
        }
        const scrollableHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrollFraction = scrollableHeight > 0 ? (scrollTop / scrollableHeight) : 0;
        if (scrollFraction < 0.5) {
            scrollToTopBtn.classList.remove('is-hidden');
        } else {
            scrollToTopBtn.classList.add('is-hidden');
        }
        lastScrollTop = (scrollTop <= 0) ? 0 : scrollTop;
    }, { passive: true });
    
    // All other event listeners
    scrollToTopBtn.addEventListener('click', (e) => {
        e.preventDefault();
        if (landingPage) landingPage.scrollIntoView({ behavior: 'smooth' });
    });
    mobileMenuToggle.addEventListener('click', () => {
        navbar.classList.toggle('nav-open');
        document.body.classList.toggle('noscroll');
        scrollToTopBtn.classList.toggle('is-hidden-by-nav');
        const isExpanded = navbar.classList.contains('nav-open');
        mobileMenuToggle.setAttribute('aria-expanded', isExpanded);
        const icon = mobileMenuToggle.querySelector('i');
        icon.classList.toggle('fa-bars', !isExpanded);
        icon.classList.toggle('fa-times', isExpanded);
    });
    const overlayButton = document.querySelector('.overlay-button');
    if (overlayButton && landingPage) {
        overlayButton.addEventListener('click', (event) => {
            event.preventDefault();
            const targetScrollY = landingPage.offsetTop - window.innerHeight;
            window.scrollTo({ top: targetScrollY, behavior: 'smooth' });
        });
    }
    window.addEventListener('touchstart', (e) => {
        if (window.innerWidth <= 1024) { lastTouchY = e.touches[0].clientY; }
    }, { passive: true });
    window.addEventListener('touchmove', handleOverscroll, { passive: false });
    window.addEventListener('keydown', preventKeyboardJump, { passive: false });
    history.scrollRestoration = 'manual';
</script>
</body>
</html>